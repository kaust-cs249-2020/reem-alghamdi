"""
@BY: Reem Alghamdi
@DATE: 02-09-2020
"""

from ch1.code.ch1_11 import neighbors
from ch1.code.ch1_2 import max_map
from ch1.code.ch1_3 import reverse_compliment


def hamming_distance(str1, str2):
    """
    this function takes two strings, then return the number of off digits between them
    :param str1: the first string
    :param str2: the second string
    :return: the count of off digits
    """
    distance = 0
    if len(str1) == len(str2):
        for ch1, ch2 in zip(str1, str2):
            if ch1 != ch2:
                distance = distance + 1
    return distance


def approximate_pattern_matching_positions(text, pattern, d):
    """
    This function takes a string and a pattern and an error threshold,
    then return an integer array of the indexes where the pattern starts
    the pattern is matched once the hamming distance is less than the error threshold
    :param text: the string
    :param pattern: the pattern to match
    :param d: the utmost hamming distance
    :return: an array of the start positions in which this pattern appeared
    """
    positions = []
    for index in range(len(text) - len(pattern) + 1):
        substring = text[index: index + len(pattern)]
        distance = hamming_distance(substring, pattern)
        if distance <= d:
            positions.append(index)
    return positions


def count(text, pattern, d):
    """
    This function returns the count of a pattern in a text with a threshold error.
    This is my implementation before seeing the pseudocode. I just called the approximate_pattern_matching_positions,
    which returns an array, then calculated its size
    :param text: the genome
    :param pattern: the pattern to be searched
    :param d: the hamming distance allowed
    :return: the number of times the pattern or its variation with max hamming distance of d appeared
    """
    count_ = len(approximate_pattern_matching_positions(text, pattern, d))
    return count_


def approximate_pattern_count(text, pattern, d):
    """
    This function returns the count of a pattern in a text with a threshold error.
    This is the pseudocode implementation. It has the same output is my count function
    :param text: the genome
    :param pattern: the pattern to be searched
    :param d: the hamming distance allowed
    :return: the number of times the pattern or its variation with max hamming distance of d appeared
    """
    _count = 0
    for index in range(len(text) - len(pattern) + 1):
        substring = text[index: index + len(pattern)]
        if hamming_distance(pattern, substring) <= d:
            _count = _count + 1
    return _count


def frequent_words_with_mismatches(text, k, d):
    """
    This function takes a long string and a k-mer length k and the max hamming distance allowed d
    Then returns the words with HIGHEST frequency.
    :param text: genome
    :param k: the k-mer length
    :param d: max hamming distance
    :return: array of strings representing patterns of highest frequency
    """
    patterns = []
    freq_map = {}
    n = len(text)
    for i in range(n-k):
        pattern = text[i: i + k]
        neighborhood = neighbors(pattern, d)
        for j in range(len(neighborhood)):
            neighbor = neighborhood[j]
            if freq_map.get(neighbor) is None:
                freq_map[neighbor] = 1
            else:
                freq_map[neighbor] = freq_map[neighbor] + 1
    m = max_map(freq_map)
    for pattern, freq in freq_map.items():
        if freq == m:
            patterns.append(pattern)
    return patterns


def frequent_words_with_mismatches_and_reverse_compliment(text, k, d):
    """
    This function takes a long string and a k-mer length k and the max hamming distance allowed d
    Then returns the words with HIGHEST frequency.
    This methods accounts for neighbors AND reverse compliments
    :param text: genome
    :param k: the k-mer length
    :param d: max hamming distance
    :return: array of strings representing patterns of highest frequency
    """
    patterns = []
    freq_map = {}
    n = len(text)
    for i in range(n-k):
        pattern = text[i: i + k]
        neighborhood = neighbors(pattern, d)
        for j in range(len(neighborhood)):
            neighbor = neighborhood[j]
            reverse = reverse_compliment(neighbor)
            # neighbour part
            if freq_map.get(neighbor) is None:
                freq_map[neighbor] = 1
            else:
                freq_map[neighbor] = freq_map[neighbor] + 1
            # reverse part
            if freq_map.get(reverse) is None:
                freq_map[reverse] = 1
            else:
                freq_map[reverse] = freq_map[reverse] + 1

    m = max_map(freq_map)
    for pattern, freq in freq_map.items():
        if freq == m:
            patterns.append(pattern)
    return patterns


if __name__ == "__main__":
    print(hamming_distance("CACTATACGCCTTCTTTCAGAAGTAGGTGCATGCCTAGGCGACTGACCGATTGCGTAACGTTACCGGCGTCAGGAGCGTCCAGCTCCGCCTAGCAGACGTACATAAAGCACAATTTCTAGCCATGCTGCCCTCGAACACCCTATAATGTTTCGTCCTCACGGACTGCTGGGTTGCCTAGTGCTGTGTTCTCCAATCTCCCACCAATTTGAATCCATTCGGTATTTTATATTGAGGAACCTTACATCCGGGTTGGATATTACAAATCCTAGCCGCTCATACCGCACCAGATCTCGACACTCAGAGGGATCCCTTTCCTTAACCAGAATGACGAATTCTGTAACAAACTCTGCATTCCGTACTTATACCTTCTATGTTGGTACAATCCCGAGCGCTTCTCGCCAACCGAGCTCAGTCCACATGGGCTCCTGCGGGGCCGAAAAGATTGTTGTGGTACTTCATGTATCGGCTGCCTTACTGTGGGTTTACCCGCGCCATACCAAACTATCTAGATTACAGTTCTGGTGTGAGGCACGGCTGGTATATCTCCTGTCAAACTCCGTGGCTAGGAGGTGCAGAATCTGCAGTAACCGGTTGCTACAGCTGAGCGGTTAGCGACAACATGTTCCGACAAAAGTTCTGTGAGGATAGACTGATGAGGATCAGGGCTACTGGCACCCATAGCTTAGAACGCGGCTTACAAGGGGGTTCATCCCGTTGAGATGAAGGGCTGGGCCAGTGGAATCCGCACGCGGAGAGGTGGGCAGTTCAGCATCAACAAACATAAGGGCGGAGACTCAGAGGCTCAGGCAACTACGCTGAGTGGCAAAAGTAATTATTATCATACCAATACATGAGCCCATACAGGTGTCAAGGGGTTAGAAGAGAGAGGACTACAGTAAGTAATTAACAGATATCAAAGCGAATCGTCGGATGAGAGGATCTGATCCAATCATACGCCTGGGTGTCTTACACAACGTATATTATTGTGCTACTTGCTACGCATGCGATGTACTCTACCCTGGCCATACCCTTT", "CGGTGCGTTACTATGTAGACGCCTGTCTCTAGACGCCGTCATCTGGAATTACATAGTTGCCAGTGTAACGTGAAGGCTGAGGGCAATTTTATTACTAGAGATGGATCTCACACGTCGGTTTATGATAATGGGCATGTGTAGCTAAGTCGATTGCGCTCGTTGCGGTTCGTATACGCTTCCGTGGGTGAGTGGTGGGAATAGCGATGCGCGGCGCATCTATTCGTGAAGTTTGCATGCTGGGTCTAGGTAGCGCACCTATTCCCCTCTAAGAACTACCCGTGAGGTGTACGGTTAGTCGTCATCTCAAGTTTCTTCTTAGTACTTAACCTTCCAGTACTTTAACGTTCATTATAGTGGATAGATCGTTATGAACACCCATAGGCAACATTTGCGCCACATCGCTGTTTTCTGACGGCAGTACCGGGGGTTCGGCAAACTACAGTAGCGTTGGCAACTGTAGATTATCCCCTCGGCGGAGGTTCTGTCCATTGGTCACCTTTGGACTGAGGTTGGGCGAATCAAAACGTCCGGACACCGCGGATTGAGTTACATCCTGACTGTGAACCGAGCCACTTTAGTAATTGACGATGATATACGATACGTAATTTGCCTTTATGTAGTTGGCTCAACGGACATCGCTACCAGAACTCTCCAGTGATTACGCGGCATGGTCGCCGAATTGCGAAAATCAGAAATTGAAGAAACTTGCGCGTAGCCAGTATACCCTGGCCGTCTCTGGTGAAGAAAACGCGTGCCATTTTACGCCGAGGATCACAATCCCCCCTAAACTCTCATTGATAGCAGCTGCGAAGGCGCGACCTGTGAATTACTACGCCGGTAAGTGCATAATAAGCCGTGCTATATCACCATGCTTGCGACTCGGAAGTATAGAAAATGTTGTTCCAGGAGACTTCTCCGCCAACTCCGTTAAAAGTTCGGGCCCGGCCCTGCACGATATCGAATTGGGCGTGGAAGGCGTAATATTGGACTGTTACTTAAAGGATGAGTCAGCCGCACGACGCCCACTCCGTCAC"))
    print(*approximate_pattern_matching_positions("GTAATAGTTGATATGAATGTTTCCCCGGCGCATTGATTGGGTGCGGTTGTCGCCTGGAACAGGGTGGGGACCTTTTGCTAAGGAGCGGGTCCCACAACGCATGAAGCCGCGGACAGTGCTCCAGCTCTAATCGCGACCCTGTGCATACCGCCGTATTAGAGCTCCCCACCTCCTGTCATGCAGCGACTCTTTGAAGAGGTCTTAAGCGGAATGCAATCCAGCGAATATTAACGTCTCTGGAGGGTGGAAGGAGACTCGCTGGCATAACAGCAGGGTATCGAGCGTCAGAGAGTGACGCAAGTCGAAATAGTGTTTGGTCCGATGGGCGGTAGAGGTAGCTCGTTTACGAATGATCTGGGGCCGTGAAATAAAATGTCCGCCACTTCGTGCCTATTTAAGGCTAGCCACCCGGACCAGTGATTCTTTGCCGCCACCTTAGGCTCGGGAGCTCTCCAGCGACTCTCGCCGGTCGGAGTAGGTCATACCTAGGGATGACGTCGGCGGTTTTCCCTGATTGTAAGGGATCGATTAATCGGCGAACTCAAGATGGAAGTATTTATGGGGGACCGCCAAGGACACAAGATAAACGTCATGTGCATATTTTTAAGTAAGCATCCTGATAACTGCGTCAACGAGGGTTTTAGCATAGCCTATGAAACGTCCTCGCCGCCCAGTAACTAGGCGACTCCGCTGCTGCATTAGTACTATGGCCAGGTCTGTGAAGCTAGGTGTACGTGTATATAGATTTGTACTTTGTTGCCAGGAACACGAATAGAAATTTCATAATTTTCTAGGCGTCTACACGAGCAATCCAAGTAGGGCCCAAGCTCCTCTCTACTCTAATCGGGCTTCTTCGTAGACAGTTCTATTTATTCGTAGCCTGGCACGTTTAACTAGTCATAGGAGGAACAGTAACTAATTTAGGGGTCGCTCAAGCCCTCAGGCAACTAGTAGCAAATACAGGCGATTCAGTAGATTGACTACTTCTCGGGCGGGTTCTGAACCCTAATCATATAAGACCCGGCTTCTCCGGCTTACTGATTTGTCAAGCTGTAAAGCCTCGTACGACTCATGACCGGTGAGAAATGGGTCGCTAGTACGAATATGTATTGTTCCGTTTAATAGGGCCGGAACCATTTGGCCCCAACTTTAAACATTTCTCCAACCGTCATCCGGCGCCATCTATACGTAAGACAACGTCAGGCTGACCCAAGCCTGCGTGCCCAGGAGAGGACCGCACGTCGATCGATCAAGAGCGTCTAATCTAGTCTGCACCTTTAAGCGTGTCGAAAGGATGAGTCAACGATGTAAGGGTCGGCGCCCTGGCCCTTCATAAGAATATTAAAGCTAAATGGTAAGATGTGTGCCTGCAGGCACCTCAACTGGGTAGAAGACCCCTCACAATGGGAGTTCAAAACTCTTCATCAGATTGCGTAGCTCTCTCGAGTCAAACCTCATTACAAGAAAACAGGCTGATACACCTTCAATCCTACATTCCTAAATGTTGGGGGACTATGCATCTGGAGCATACCAAAGGCGCCGGCGACAGTCAGAAACATTCTGACTGCTCGGCGGCCACAGTAAGGAGAAGCCTCAAAAAAACGTCGGATGAAGATGTACGCAGTGGTGGTTCGTCCAGGAAGTCCTTGCGTTCATTTTCTGGAGGGCAAGTTGTGGCGGCCGCCCCATACGAGTGAAGCTCAATACCCGGATCCAAAGCACCACCGGCACCACGGGGTCCGCTATCATTGTAATACGCTATACAGGCTTTTTGATGCTTGCACGATCCCGCGGAAAGGTGCTGAGCACCTAGGTGAGTCTTACGTATTTAAATGGTGTACCACGTGACTTGTGGGAACGACGTCAAGCAGGGTTATCGGGCAATCAGCGTGATGTACGGCCAGAGAGGAGGTGGTACTGGCTACTCGGCCTATTGACCATACTATCATATCGATTTCAGACTTGGTCAAACCTTATCTTATTCAGACGTTCTATCTGTGCCTGCGAGGACAGCGAAAAGCTTAGGCACTACATCTCTTAAGACAGGCCGGGCATCTAAAACGGTGTTGCCAAACACTCACTATAGCGCGATGCAGGGCAACATGCCGCTCCCGGGAGTACATACCGCCCATAATCAGCTCAGGTGGGCTTGGTCCTTAGGCTACTACCGCGTGAGGCAGACTTCCATCTTTGTGGTGTCCTGATGGGGTCGGCCGAATATTAATAGGTTACAAAGCGGCCGAAATTATCAGGCATTCCACTATTTACCTCTTACACCTCGAGGCCTCGCGCGACTCGAGCCCCTTAGTTCGCGCCCAACATCGTCTACGTTTCGCCATGGCGCCATCGGTTATTGAGAAGGACCGGATATATCGATTACCGCGCCCGATGTGAACGATGAGAAAGTTGACTGAGCTATTATCATTCCATTTGCGCAGCTATACTCTTAAGTGGGGGGGAAGAGCCCAATGTGTGAGCTCTACTGATTCACCTCGCAGACTGAAACCTGGGAAAGTCTGCCAACTTGAGGGGACCTCCACATGGCTCACCTACATAAAAATGTACCAGACGCGCCTTTTTTATAACTACGGTTTGAAACCAAGTTTGGACTTATCCTCAAAACCTGCCCTGACGGCTGTGCTGAGCGTTGGAGCTTAGCTATATGCCGTGCGTAGCGCATGCCGGAAATCTTATTTGAAACCTTGGTAGCAAAGTGTTGGTTGCATCATCCGATGAATTGTGTTTATTCGGCCTTCGAAATTGCTTGTCCTTCAGATTCGCCCACCCCCTAGCCAGGGCACTGATCGAATTTAACGGCTTTTACGAACCCCAGTAAGGGAGTCCATTAATCTGCTGTAGCCAAGGACTTACTTTTATGCAGGAAAGTAGTTAAACGCCCAGATTAGGCGTATAAATGGATGTGTGTGCTAACATTTCCTATAGCATATGAGTTTGTTAATAGACGAATACTTGGTACTTCCTGAATTTCTAACACACCGCACGCATTACAGTAAAATGTTCTAGTCGCACCGCATTACCGATCAACTAAAAAGGCCGGGTTGCATTACCTCTGCTCGTTCTCCAGAGACTTGCCAGCCTACGGGGCTGCCTGATCGACTCTAGTGTCGACCTACAGAGGTCCGTTGCTCCATAGTTGCTGTGTCTCAACATCGCCTATCGACTACATGCATCAGAATTGAATGGAACAGATATAGACGAGTCCACTCACCGGGACGGAAATGACAGACATGGGCTGCCTAGTATTGCGATTTAGGCACAGGATGTAGTATTACCTCATCTGGTGCCTCCAGTAAATATCGATGCCTTCCTTATAAATCAGAGACCGACACTGGCAGGCTGGCGTTTGCGACTTGCTTGACACGAGTTCCCCTGTACTGAAGAGGGTTCGAGGCAATTTGGGTACACGATGAGAAACCATCCACTACTTATTTGCACGTCTGACAGCGATCATACCATTAGGATCTCACCATTACGGTAAACATGACATATTGTAACCGCGGACACAACTCAGAGTGAATGGAACAAATTCAAGTGCTGGATAGTTCCTACGCCATAATATGACGTTACTTTGGCCCATGCCCAGATCCTCCTTGTGTCAATGATAAATATCCCATTACAGGGGCGGGAAAACCTGGGTAGAATCAATAACTGTCTATAAGAACATTCTGAAGATGGTCTCAAAGAGGGGGGGCCCACTGCTTCGACGGGTTTCTCTTAACAAACCCCCGACCGCACACACTCATCAGGACTATGAAGCCTCCCTATCGTAGGGGCAGCTAAATAACTACGAAAAGTGGGGCCAACACACTACGAGGCTCTATAGATGGTGACCCTCAACCAGCGGCCAGATGCGTTCCTCGGTAGAGCATCATACAATTCCAGATCGATTTCCAGGTACGTGCCCTCGGAGCGTCATTAAGATACGCCAAGCCGGGCTTTCGACGATTTTAACACCACGTGCGCAGTGCAAACGGTCGATAGGGGGCTACAAGGAGACAATTCCGCGCGTCGCAGACGCAGATTGGGTATTCTTATCATTGAGCCCGTACTGGCGGTCTCAGGCGCGAGGATGACCGCACTTCACGTAACTTTTGGAGAGGACGCTCTTGAACGCACCCACTGGTTTATCAATCTGAGGCCGCGATTACATAGTTAGTGGGTACACTATACCCGGCGTTGCATATCCCCCACTCCTACGTCTTACTGACTATTGTTGACGGCTCGAACTATTTGCGTTGAAAGTATTACAGAGATTATACTCCCCGCTCCCCGCAGTAGACATGGGCCACAGGTATGTCCCATGCTATTCGTTTGGAGGGAGAGGCCTCATTTGACAACCTCGCAAGTGAATATTAATTTCGTATGCCCTCCTAGCAGGGACTGGGGGCAGCTTCGATTAGCGCGCTGTCTGTGACTTATTCACCGTCTAAGAAAAGGATATGGCTCCATCTCTATTCAACTCAATTAACGCTCATACCCCATAATAACGCATAGTCACAGCTAAAGGGGCAGCCGCGAGCTGTAGCGCACCAGCGAGTGGCCCAGCAATTCACAGTTTCTATGGGTGTAGCTAGCAGACAACACCTTAATAGATATGGGCAATACTATTGCAGAGTTAGGGCGTTACAGGGGACCGTTAAGCCTCGAACATCTAAAAACTGTCCGTCTGCCTGCTCGCTAACAGACGTGACATGATGATGAGTTCGAACTTCCGCACGCCTGGCGGCTAAGAAGCCCTCAAGTACTTTGCATCTAGTGATGCTCTCAGTGGCAGGTGGGATGTTAAGAACAGCATTCACCCTTGTAGTCCTTAACGTCTCGGAATTTCTAAGCTATCATGCCCGTGGTTATCCTGTTTATCGGCATCCTAATTAGGAGCAGGCCCAATGGACCTCATGGAAAGGGCCGGCTCCCGTGGAGAGAATTAAGTTCAGGACGCGACTTAAACAATTTAGTACACATATTTAATGGGCACAGATCTTATATCGTGAAAACGACAAGATCCCCTGCACATACAAGGAAGTTTGCATGCCCCGTCCAAGGTCTGTAGATCACCACGCATGGACTGTCACAGTGCGCGAAGGGTTTCCCCTCAACTAAGAAACGTGATGCGTACCTTTAAATGGGTGGCTAACCGTCGGTTTGCATACGGTATGAGATTCTAGAGCAGAACCACTTTTCGCAGACCAAATACATGGGAGCAAGAGAGACTACGGCACTTCGGCAATATTTCGGTGGCAGCGCTCTAAAATATTTGTTACAAACCCCACTGATAGGTCGAGACATATCCTCGCACTACAACCATCTCTAGACATAGGCACCGTTACGGGCGATCACTGATGCGTAACCCCTTTCGCCAACCGTCTCATCCACAGGACGACTGGCCGCATGATCAACGAGAGCTCAACACATGAAGGGAATGCTGAGACGCTCGGTGTAAGTCAGACGTCCGCTGAGACTGCTTTAAGTCAGGATTTCATTTTGGATTAAGTGACAGTTCATAGTACTTGATGCCGGAGTCGGGATGCACAGGGTTTTCGTATTTTAGTCCGTAGGGTCCAGAGTGGCCAGTTAATTAGGTCATTATTGTCGTGCATCTCCGCATAATCGCGGCTGTAGTGAGCAACTATATTCAGGAGGGTCGTGCTTACCATATCCATTGAGTTGCCCTATTGTGAGTTAAGCCTCACACTCGATCATTAATCTAAATATAGATAGGGACATTTGCTTGATGTGACACGATAAGCCTAACGAAGTTCTACTTATGAAGACACGAAACGTTCCTTAAGCTTCCTTCGGGATATGGCTCGTATTATGGAGCGATATCGCCTCGTTAGCAGAAAACGTACCAGAACATGTTACTTGTTACGGGCCCGTCAATCTGGTTTCTTCGTCGAAATTGATACAGACATATGAATAAGGTCTCACCACCGCAAATCGTCAGTTGCGGCGAGCCTAACCCACACGTAAAAAGTGGATATCGTCACAGATGCAAATAGCGTTTACTACATAAAACGCGTCGGCTAGGAAGTGCTGGCGGGTGTATATCGACCCCGGAAGAAGCAGTACAGGTTATTGTCAGGCTGCCATACTCGATGTTGCAATGAATCCTTCGCACGACTCTCGTCTGCACTGCACTGAGTTAAATCCGTTCTGTTCAGTAATATACGCTTAGAAAGAATTATTCGCGCGTTTAAGGGCGATGCGGTCACTTAGCGGCAGCGCCTGGCCAGTCCTTTGATCCGTACTTCCATGTTGCAAAAGCCTTACGGATGCTCCTATTGCCCTGAAATGCACCTTATGATCGCACATTGGGACCGACAAGTGAGCTATCCTATAAATGTAATCGTGGTACTCTGGAGCGAATTGTCGCAACCTGGTGAGCCTACCTATGGGTCGAGTAACCTAGCTGTTGTTCGATGCGTCTTTGTAGCTAGCCTCGTATTGGGAGCCTAGGGTGCCTAGACTGGTGGTGGATAAACTAAGATATCCGGGACCGACGATACCCAAGACAGTAGTTACATGTAGTCTTAAGAGCGACCTCCCAATTCCCAACACGTGCACCGTGGTGCGAAGTACCGGGTCCTTCTCCGTGAAATAGCCACGGCGTGTCGCTGTGCAGTCGGTCAGACTTTTTGGGAGTGGTCCGGATGATATGCAGTAAAACTAAGCGTGCAGACTATCCTCCGTAGCCGAATCTCTGTTAGTAGTGGTCCCGGAAACTATCGTCACCGCAATAACAATGACCAGCATAGAAATTAAAAAAACACAGTCAGACCCCTCAATGTCTTCAAAATGCTACTGTGTAACGACCACGTGGTCCTCGTTGGCATTTACTCCACTCCGTAAGAGGCCTCTACGAGGCCAGATTTCGTAGTAAGCTTTGTTTTCATTAGAAAATTGGCTCTAAACTACGCGATACTTGCGCGTGCGCGACTCAACGACATTTTTCGAACACATGTTGAATAAGGGTAAGATAAGGGCCGTTGGTTATTAGATCGTGGAGTTAGTTTGCCGGTTACAACAACTATATATCGGTTCGGGCAGGGACATGCTGAGGTCGGTCAGACCGGCGATAGATTGCGTTAAGCTGTGCCAATGCTGAACATCCATACGCTGATCAGCTGGAAAGGGACTAATCACCCCTCGTAAGACTCACTTATGCATAATTTATAGACCCACGCAAGTATCGCTTGCCAGAGATGGCGTGCCCCCCCGGGTGTATCTGCATGTAAGTAGATGTATCCTAGATCAATCATTGCTAGGGTGTTCTTGCGTTCCGAGAGACGCGAACTCATACTCGGATTTGCGCACTCCGCAGCATCCGTTATTTACGACTGTGTTCATGCAAATTCCTGAATCGGCCCTGTGGGACTCGCTGGGGCGGGTAAAATCAAGTTCTGCCTGCAAACGTCGAAGAACTTCAACTCTTCTCAACTTGTGAGACACCGTGAATATTCGAAGCCGACGGAAGGATATTTATCGGGAACCGGTAACTCATCTTGGCTTGTTTTCCCTCCCTAGCTTGGCTGGTTAACGAATTTAACCCTACGCCCTGTACTAAGCAAATCTTGACTTAAATTGGGCCCCATTTATACAGGGCTCCTGCGGGACAGCAGATCCATGATAGTATTGGGCAGCAGTGAGCTACGCCCGTGGGCCCGAAAAGTACCATGCGAAGCGAACACCCCTACTCAGGAAGAGTCCTTTCATGGTATGCGATGACAGATTAATCGTGCGATATCTGCACTAAGAACACACCGCTGATGATCAACGCTGATTGGAAATACCATGGTAATTTTAACCGAAGTGACCTGGCGCTTACGGAAACCTCGGCGGGGAGGCTTTTTGATCGACGAGTCCCTTTTTTGAAGGGAAGGTTAGTAGCACCCGCAGGCCCATGTGGTCCTAGCAGATTCAGCGTCTTGAGGAGACATCAACGTACCAATGCGCCGGAATTAGCCAACACAGCGGTAACAGCGCGTGATCTTCCACAAAGACATTTAACCGGTGGTAGGCTCGAGAGAGTCCCAGGCGGGGGTACTTCGCGGTATTGGTTTCTGAGGCGGCCGCACAGGGTAAATACAGGCCTCTAGGCGGAAAAGTAGAGGATTCTAGTGCTCGATTGGTCCTGCGATTGTATTACTGAAAACGGATTCTAGTTGGCTTGGAGCTGATTGGCATGAACCCACATAAGCAATTGGCGCAGTCTCCCGCACGACCCGAGTCGTGACGGCTCACTGATTAGCGGAGAGACCTAATCTTCTACACTTATCAAACTACACTCCGCGCGGGTGCGCTTATCTCAGATTGCGAAACTCAGTCGCAAGGCTTTGGCCGCTGGATTCGATTTTACATCTCAATGGTCAAAGTTTGCGTTCCACTGGCGGCCCCTCCTGGTCCGAAGATCTTAAGCGAGGGGCTCTCCGTAAGTGTAAATTCTGTCGGAAAATCTAGGGTCCCGGACCGGCCCGTTTGATTTCAGGGCGGGGAAGTAATTTACGTTACGCACTGACCCTAAGATCACGATCTCGTCCAAAGATTGAGCGTTACGAACTGGGGTCATGATCGGGGCCAGTTTCTTTCCTGCGGTCAACAGCGCGAGGATCTACAGCCTTTTTAAGACTCAATGATAACCTACCTACCTTTAAGATTAGAGACCGCATAGCGCCCGTACCTTGTGCGTTATATATCGGTATCATATTGTCCTTCCGGACTGAGCTAGTGACAGTCACGTTGCGCAGATGCACCCTCGCAGTTCACGCCATGGTTTAACGAGCTCAATAAATTTTGACGTCCACCCACGCCTTAAAGGCCAAGGACTAATGTGACAACACCTTTGACAGACGGCAGCTCAATATGAAGTATTGGCCGCGCTGCCTAAATGACTGTGTCAGGCCGGTAATAGACACAGAGTAGGCAAAATTGATAAGCGTCCAAAGGAGGGTTAATCTTCTAGGTTATGTACCTGTATGCAAAATTAAGCCGTGCCCATAGACACGAATATGGGCGATGCCGGGGGCATGACAGCCGAGTGTTTTCGGCTCCGAATCTATGCCGTTTGATATTAGCTTACACACCCTCGCTGGCTTGACACCCATGCGAATCTTGACAAGCTGAGACGGACGTCAGAGTATGTGCGATTTCGGGCACGCTGATCCGCTATTTTTTTCAGGGCGTACCGGCTGTTGCCACCTACGTGAAGATATCTGTACACTCGTCAGGTCCAAAGATTCCCAACACTACTGAGGTCGCCGGATCCCTCTCAATCTCGTCACTAGCGTATACCCGGAACCGCGAAGGCCACCGTCTTGCACGCGGGACAGCTATGTCGTCGTGTCAGTGGAGCAGAGATTACAATAGGCAGGACGGTAGAAAGATTCTGATGAGAACACGCCAGACCCGATATTTCTCGACAGTTTTCAATATAGTTAAGCAACGCTATTACCTATTAGCAATTGCGCGAGTCCAAGGTTATGTCATCTCAAGGACAGGGTAGCCGTTCTTACTAGGGCCATTAATGCCGTATAATCTCCCTGAATACGGCCATCGTCACTAGCCGTCGATAAAACTCAAAATCTCCTCAGGCTTCCCGTGCCGTCAGGACTCTATTATCACGGATGGTGCATTACTGAGCGATTCCCACCTGCCCTTTGGCTCAGCATAGCGAAAAATGACCGACATCCGATCTTGCTGGAAGCCACAGTTTTTCTTTTCCACGTTTGTCTACAAACGCACAGATTGACCAGCACTCAGGTACGGGAAGCGAATGGGTTGCTTTAAGGACCGGCGCGACTAGTAGTATATCCAGTGTCGGGCCGATAACCGGTCACCACAACTGCGAACTTGACCATTATGAGGAGGATGGTGTTGTCCGCCAACCCATCTGTAAACCTGGCGGTCACACGCCGTCATCCCACTGTTGTTGTCCTTTCGCAGCCAAAGGTGGCCTAGTTAGCGGACTTGATATCTTCGAGCTTGTCGTGGCTCAGATGTTAGCTAATAGCCCTTTATTCGCTAGGGAGGATACTAAATGCTAAGGGAATTCGCGACGAAGACGTGCTCGATCCGGGTGACAGCCTGAGATTGACAATCTTGTCCAAGACAGTATCCCGGTCACAGACCGTGAGGTTCTGAAATTCTGAAAACCGATAACCCGCTAGGTTGGCCCCCCACTGCGAGTGTTGACGGTTTTTCACGTACCGCGGAGAGGCCCTTTTTGTAGCATTCAGCTACGCCCGGGTATCTGATTCCTAAGCTGGTCTAGTCATGCAACCACTAGAACCGGCGTAGGACCTGAATCCGTGGTAGTTCCATGAACCCGATGATCTGCGCATCACACCGCTGGCACGCCGATCTCTCCGACTCCGACGTCGTGGTGATCAGTAACTATCCCGACTGTTGTCAGTGAAGCAAACCAAACGCTCCCGAGACTCACTCCGGCAGAAGAGATTTATCAGTTAAGGAGTTTCGGTAGCATGCACTCAAGAGGGCCCACTATCATAAGATGGGAATCCTGAGGTTGACTGACATTAGCTGGCGCCCACTTCGTTTATCACTAGATCTCACGCACTTTCGCATGATCATGGCTAGTGCATCAACCTGGAAACTTCATTAGATGTACTACTATGGTATCCATTTCTCAAGAACTGATGTCCACCTATCAGCTGACGGCCGGTCTGCAATTATTGATAAGGCGTCAAGTAGTCGTCCAGGATTAAGTGCGTCTCCTGATGGAAAATCCGATCACAAGATTAACCTACTATAGCGCCAAATTAGCAGTGTGCCGCCACCTCCTTCTTAGCCCGATCGCCCGGCCGAGGACTACATGCTTTGGCTAAGTGTCAAATTACTAAAGTCACTACTGCGAGTCGTTTAGCATTATTATATGTTGTTTCCGCGATAGGTCGTCTATGCCCACACCGACTCGCCTCCCGTATCCGGGGTCAACAATCAGGCGCAGGTAGAGGTCTCGGTGTTCTTGGATGTGGAGGAACAATTTATGAACTTATCAGCGGCCGCCCGGGGTCATGCTCTAGGGTCATCAAGAGAGACCGATTAACTGTACATCAATTCCGCGACGTCGGTCGGAGACAAACTGCGCGGTTTTCATATGCGCCACCATGGTCAACCGACCGTACTCTGTCGGCGTAGCTGACGGCTGACCATCTTCGTGACGCTTTGGCGGTCTTTGGTTGCGATTCTTTGTACTACTGAATTTCCGAATCCAGGCTTCCCGCGCCAAACAGTCTTTAGCTCGGCCGGCCTACCCGGACGGGCAGGAGGCTCGATTATTTATTAGCCCCACCGCGGCGAGGACCATGCTTAGGATACGTCGCTACGAGTGCGGTGAATGATAGTGGTTTAACGCGACAAAAGCGGCGCTCAGATCGGCATTTTTTATCCTTGAAACTTAGAACATAGGGCAGCATGATCAGCCTCCGTATGTAGGTTCATACCACTCCTGTGTCCACTTCGTTGTCGCCGTGTAAAAACGTAAAGCGGACTCTTGAAGCCACCGCTCCCGCATTGCGGTCTTGTTGTCTGAAAAAACCTCATTGCCTACACCGTGCAACCTGCGACGGTCCTTGGAGTTTATATCGTATGTTCTAGGTCCAACATGGCTGCACCTAATACGTGTTCCTCCGTGCTCACGTTGGGCGGTGACTCCTAAGCCTCTCATCTCAGTCGCTTGGGTCAGGCGCCTCAATAGAAAGTCGTCGTTCCAAAAAGTGTTTCGGCTTCGCGCTACCTGTTAATGAGCAGTGACCTTCCAATTTCCGTGTGGGCTGGCGGTCCTTGTCATATATTCATCCCCCTTCTCAGCCTACTGCAGCACAATAGCAAGGGGGCGCCTTAACCTGATCAAGGTAGAGACCGGGACCGGACCCGCGTTAGCTCGCCGACACTCGACGTTTCAAATAGATTGAATTTGGGGTGACGCTCTGGGAATTGATTACGTACAAGAACTGTTTTTCACCTAAATATGACCAACCATGTCGGGTGGACGGTGGGACCGCAACCGTATCTGGTCTCAGAGAAAGGAACATGGTGGTATCCGATCACGCTTTGCAGTTAGGCAACACCGCAGCAGCTATAGTTTCGCATTGAGCAGTGCCGGTAATTTGGAGCTTGATCTCCCTTGCTCTCACGCCACAGACTTCCCAACAAGGTACTTGGGCAGTAGAACACGTTAACACAGGACGACGCGCTCCTCGGATCTAGAGTGACTTTTGCACGCTGCGATCCGGGATCATCTGTGACAAAAGTAGGATTGAAGGTCATGATGCACCGATGTCGCGTACTCTTGTAAGCTGTCCTTCTCATTGAATCCGCCTGTTGGAGTGAAAGGTGTATGGTATTTTGACTGCTACGGGTCCGTAGTCGCCATCGACAACCATTATGTAAGGAGGTAGAGCACTAGGGGATTGCTAGCGGTAGTTCTATATAATCGGGATCGGGCACGCGCTTTCGAGGAAAGGGGACCATATCTTCTCAGAGAGACCAAGCCGATGCTCGCAACGAAAGAGCCCATAGGCCGTTCTAGGAAGGATAATATCTCTTCACTGCAATTCTGGCCAAGCTGGATATCGAACCGCAACTGCGGGCTGTTTCATCTGCTAAGATATAGGCCGGCTAGATCAAGTTCCACCCTACTTGTCAATGGATTAACGAGAGCCTAGTATGATAAATGCGTATTATAGGATTCGAGGCCTGGACCATAACCAACTAGTCGCAAGACGCGGACCTAAAGGTTAAAGAAGTGATTAGAAGGTCATTTTATTCGGTGCCAATTCTGCTAACGTGGAGAACGCCCAAACAACCAACGAGGACCGTGGTCGATCGGAACGCCCTTCGCCGATGCGGGATTCTGCGCGTTACATTCAGGAGCTCCAATTCAGAGATTGCCGGGACAATCAGTCGGAACCTCCACGGGGATATTAAGCGCGGCTATATCTGCGTAGCTTAAATCCGTTCAAGAATCTAAATAGCATTTAGCTCATAGATTAGTCTAATCTTGTAGGTGTTACGCAAGGCCACAGTGCTGCTCAAGTGATACACCGCGGTGTGAGTAGTGTAAGACCGCAAACGGACATTATGTGGTGTAGTTATGTCATTCGCGCTCTCGGAACACGCATTTACCACCATTCAAGTGACGCGGTTTCGGTTGGGGAGGCCTTTTCGAATGCATGTCAGAAGCCATGAAAGTAATAGACGTTTTTGAGGATGTCGATCTAGAAGACAAGTTGGAAAGGGCAGCATCTTAGTGCAATTCCAAACACAAATGTTGTTTGACCCAATCAAATCAGGAGAGTGGTAGTATGCACCAGACTAAGGGCCCAAATCCCAAACGGTCTCTACTGCTCACGAGCACTAATGTTTGCAAGTATTACTATATTCACCAAATAGGACTTAGACACACGACATGTCTGGTTCTCCGTAGATCGGTTTAACTAGTGACCCGCGAGCTAGACACGAGGCTACTCACTGTTAAATATTAGTTGTGAACAAGAGCTTGCTCGTCTGCTGTGATAACTATCCTAGTCATTAACTTGCAATGTCGACCGACCCACCAAGCGTAGTGAGACAAGACTGTCTGAGAGATGGTTAAGGTGGACTAACAGCCACAATTATCAGGGCTGCACCCACCCGTGTCCGTCAGTTGCCATAGTCGGTTGCACTTTTCACTTTCCGGAGCGGGTGATCTGATTGTCTCATGCAGCCCAACAGAGGCGTCATGATGAAGAAAGCGGTTTGCACCGGCTTGGCGTCCCGAATCCGAAAGGTAACTTCATGCGATTAACACAAAGATAGATACCTTAGTCGATGTGCAGAGGGTTGTAGCAGGTGATGCGTCGGCCCATTTAGGACGGACGTAGTATGGGTAAGTATGATCTTCTGCAAGGTCGACACCGAATTTGCGGCGGATAGTTGGCGAAACCTAACGTTTAAGGTCCGTGCTGGGAGTGGCCATGGGAGAACAGTGTTTCTCCTTCTATTGAACTCTCACCCGGAGGAGTGTTTGCTAGCCAGAAAGAGATATTCCCCATCCAGGCGCTTGCTAGGCGCATTGATTTGGCTTAGACGTCTGGTTATGGTCTGAGTTCGGGGGTATGCCGCTCAGAGTTAGATTACAATGTTACCACAGCATCCGGAATGTTAGACTGAGACCCTCATTAAAGGCCACCATAATACTGGTTACTTTCCCGCTCTGGAGTTTGTACGAATTCTTTTCGTTTATTGGTATAGTGCCCATCGAGAGCGCACACTTACGCAAACTTCTATTCGTTCCCCATAGAATTTCTGTTTCTGTCTCGACTTCATATCCCCTAGCGGACGTCCATAGCTATCACTTTTCGTGCATGGAGCGCTTGTGCAAAGCAGCTCCGTTGGTCTGCTTTGTGTGACGGAAATGCCGGGAGGATGTTAGGAGGAACTTACTGACGAAATGTCTTTACTCAGGCCCATAGAATTAATTGCACGGGCCAGACCCTACTGTTCCAAGTAACTCCTAAGTTATATATTAGCGCCGTCATCGTGCGTTAGCGACACTCCTATAAGGGGGCAGATTTTTTGCTGAATGCGACACTAGAGGAAGGCCAGTATCGTGCCTACAGTAATGTGGCATGTATAACTTTACATCAAAATGGTGAGTATATCGGAGCGAACCTTCTCGGCTTATCACCAGAATGACTGTATTCTGGCTAAGGGTGCCAAATAGTACGGACGTTTGCTGTGACGGACGGCTAGCGTTGGGTGCACGTTAGTCAGTCCCTAGACTTAGACCAAAAGAGGGTGTAATTTACTTACTCTGGATCAATTTGCTTGCACTTACTGCGGCGGGGGTAACATACATAACAGTTGTTGGGAGATCTGAAATTATTTCAACGGTTAGCAATCCTGCGAACAAATCATCCCGGAGTTTAAGTGACTGTGAGCCTACCAGGTTCAGCCCCGTAAGTACAACGTAAGATGGCGTGGACTTACAGAATTGCCGGGCGAACTCATGCGCGAGTGTAAGTGCTTAGGGTCAAGGTGTAATGATCACGCTCCATTCCTCGGTACAAACCCAACTTAATTGTCTGTGTGAGAAATCGCCGACTATGAGCAGTCGAACGCGCGGTTCCAGGAATTCTCTATGCCGGAGTGCCGCATAACTAATTTCCATGCACAAGACACAAATGCTGTGCCGGGCGCTAATGGGTAACCCGTATTCGCCTGATAAAGAATCATCCCGTAGAGGGCGTTTTCCGCGTAAAAGGCGCCTGTCAACAACTGTGATCTTCGCACGGTACAGATTTGTCTAAGAATCCGGCACTCGTTTGGCGACGCGGGGCCCTTGGTGGCCTTAAGTCTACGGGTTTTACACTCTGAGCTTTACTAGAGTAAGCTTCTAGGCAACGCATGCGGGGTACATAACGTACAAGTCCCAGCAAGGAACCGGTTCTCGCCAGAGCAGTGCGGATCTACCGCTTCGCCCCTGGCGCAACAGCTCCCCAGTTAGATTCTTTTAACGCGAAGGAGCATGGGCATCGGGATTGCTTGCTTCACGAGACTATGGGGTATGCGACGCCCAATTGTCTGTGCCCTAACAAGAGCGCTAGATCACTCAGTGGTGACTTATGCTACTATCTACTACGAATCGCTTAAGAACGGTTACTATCCGGACCGAATCGAACCTCCTCAAATGTGGTTTAACGCCAATGCCCGCTTGGTGTATTCCGCTGTGATGCCCCTTAAGTTGCCCAACCATTCGGTGACGTCATCTGGTTATTAGTCACGAAACGAGTACTTTGCGTCCTCTCAAAGGAGAAGCGGGTCAACGCAAGCGCCCTAAACCATCAGGAATGTACCCGCGACACATAGAACGTACCATCGTACTAATGTCCATGTGGCATTGTCTCAACGATAAGCGATGTTCTGACACCGAAAAAATTTCATACAATGCTTGCGCCTGACAGAGACGGTATCATGAGGCGCCATGATCAGACCTCTCGAGGATATCCAAAGTCTGCGACCAATCTTATTAAATGCTAGAGACATGGCTTCTGAGTATGAAGAAGATCGGTACTCGGATCAGCGAATCCCGCTCTGGCTCCTATGCTTTCCGTTGGATTCTCACCTTTCAGGGAACCAATGGAGGGACCAGTCTCAAGCGGTGTGTACCTTTCATGACTCGCACTAAGGGGGCCACTCTATAAGGGAATAACACGTAGTAGCCATGG", "GTAGCCATGG",  5))
    print(count("AACAAGCTGATAAACATTTAAAGAG", "AAAAA", 2))
    print(approximate_pattern_count("TTTTGTCTCAACGTCTCAGCGGGTCCGCGGAATGTACGTCCCTTCTTGCCCCGATTCTACAACGATAGGAGTGCAACGTTTCCGCAAGATAGCTCTACTAACGCCTCGAGGTATTACAGGTACATATCTATCGCCAACGGATACCTTGTACTAATACCGGCCTCTATAAGTCGTACATTGCCCTGTTTTAATACCTCTCCAGGCGCGAGATGAGACTGCCTCGTGCCTCAACGGCCTGGCGTTTGTGGAAGCAGCACGCTGGCGCGAGTTTTAACATAGGGAGAGAGGGCGACTTACTACGG", "GAGTGC", 2))
    print(*frequent_words_with_mismatches("GAGGAGCGCTCGATGACGAGAGGAGCGACGCTGAGTGATGAGAGCGCTCGCTGAGAGGCGATGACGCTAGGGAGCGCTAGGCGACGATGACGAAGGAGGCGAGAGCGCTGAGCGACGCTCGAAGGTGAGAGTGAAGGAGGGAGCGACGCTAGGCGAAGGCGAAGGTGATGACGCTGAGCGCTTGAAGGAGGTGAAGGAGGCGACGACGAAGGCGCTTGACGCTGAGCGACGCTTGAGAGTGAGAGGAGCGACGCTTGAAGGGAGAGGGAGTGACGCTAGGCGAGAGAGGTGAGAGGAGTGATGACGCTCGCTCGCTCGCTCGACGATGATGATGATGATGAAGGCGACGATGATGATGACGCTCGATGACGCTCGAAGGAGGTGA", 6, 3))
    print(*frequent_words_with_mismatches_and_reverse_compliment("TGCTGCACTTTAACTTCAGTGCTAACTTACACACTTTTTATTTTTTCAGTGCACTGCTAACTTTACAGTTTTACTATACAGACACTTACACTGCACTTTTTGCTTACTATTTTCAGACTATTTAACTAACTGCACCAGTGCACTGCACCAGTTTGCACCAGTTCAGTGCTAACACTGCTTTTTTTTTTTATACAGTGCTGCCAGTACAG", 6, 3))