"""
@BY: Reem Alghamdi
@DATE: 25-09-2020
"""
from ch4.code.ch4_11 import linear_spectrum


def linear_score(peptide, spectrum):
    """
    given a peptide and a spectrum,
    return the count of the number of matches between linear spectrum of peptide and spectrum
    """
    s = spectrum.copy()
    count = 0
    for x in linear_spectrum(peptide):
        if x in s:
            count += 1
            s.remove(x)
    return count


def trim(leaderboard, spectrum, n):
    """
    :param leaderboard: list of peptides
    :param spectrum: the spectrum wanted
    :param n: the array length (ties included)
    :return: collection of the top N highest-scoring linear peptides in Leaderboard (including ties) with respect to Spectrum.
    """
    peptides = {}
    for peptide in leaderboard:
        peptides[peptide] = linear_score(peptide, spectrum)
    peptides_list = sorted(peptides.items(), key=lambda item: item[1], reverse=True)
    cut = [t[0] for i, t in enumerate(peptides_list) if i < n]
    for t in peptides_list[n:]:
        if t[1] == peptides[cut[-1]]:
            cut.append(t[0])
    return cut


if __name__ == "__main__":
    sp = "0 57 57 57 57 71 71 87 87 97 97 99 99 99 99 99 101 101 103 103 113 113 113 113 113 113 113 113 115 115 115 115 115 115 128 128 128 128 128 128 128 131 137 137 147 147 147 154 156 156 158 163 163 163 170 172 172 184 186 186 196 199 200 202 202 212 212 213 214 214 216 216 218 226 227 228 229 230 241 241 241 241 241 241 244 252 253 253 259 260 262 262 264 271 271 273 273 274 275 275 275 278 278 289 291 293 298 298 299 299 299 303 310 310 312 315 315 327 328 335 340 342 344 346 350 354 354 354 365 368 370 370 372 372 372 374 375 376 377 377 377 377 379 386 388 389 390 402 402 402 403 404 406 411 411 414 423 425 426 427 428 430 434 434 436 443 443 445 455 459 465 467 474 482 483 485 485 485 487 489 491 491 492 500 501 501 502 503 504 505 505 505 507 507 512 514 515 516 519 524 524 524 533 538 539 540 542 545 549 549 556 560 561 564 571 572 573 590 598 598 600 602 602 602 604 604 606 606 611 613 613 614 617 618 618 619 620 627 628 629 629 630 635 637 639 641 643 648 649 652 654 658 670 670 675 675 677 684 686 687 688 689 700 701 705 705 713 715 717 717 719 719 721 724 726 726 726 727 728 730 732 742 745 747 748 752 757 760 762 765 765 765 772 776 776 782 782 783 788 797 798 801 802 802 803 804 805 806 812 817 822 825 830 831 834 839 841 842 845 845 847 854 858 859 859 860 861 862 864 873 875 878 879 880 880 888 889 891 895 895 896 899 900 905 910 911 913 916 921 925 932 935 940 944 945 950 951 954 958 968 973 974 977 979 979 987 988 988 988 989 992 993 993 994 998 1001 1001 1008 1008 1013 1015 1017 1020 1022 1023 1023 1024 1024 1025 1026 1036 1038 1045 1047 1055 1058 1060 1063 1064 1069 1072 1072 1079 1087 1092 1094 1095 1097 1100 1101 1102 1103 1104 1116 1121 1122 1123 1126 1129 1130 1135 1135 1136 1136 1136 1140 1140 1143 1144 1150 1151 1151 1152 1152 1154 1158 1171 1171 1173 1173 1175 1178 1179 1182 1200 1202 1207 1210 1215 1217 1218 1224 1225 1229 1230 1231 1232 1235 1239 1239 1241 1242 1248 1249 1249 1250 1250 1264 1264 1266 1267 1267 1272 1281 1286 1286 1286 1286 1288 1289 1297 1299 1299 1299 1301 1303 1310 1316 1328 1330 1338 1338 1345 1347 1348 1352 1354 1354 1359 1363 1363 1363 1365 1365 1367 1370 1377 1380 1385 1395 1396 1399 1399 1400 1401 1402 1403 1404 1404 1411 1414 1414 1416 1417 1423 1425 1427 1429 1446 1451 1451 1453 1460 1472 1476 1478 1478 1480 1482 1493 1498 1499 1500 1500 1503 1508 1508 1508 1510 1512 1515 1517 1517 1517 1517 1524 1527 1527 1528 1529 1530 1538 1540 1545 1561 1564 1574 1574 1579 1579 1585 1592 1593 1595 1607 1607 1609 1615 1616 1618 1621 1625 1626 1627 1628 1632 1636 1637 1637 1640 1640 1643 1645 1651 1658 1658 1658 1663 1664 1666 1673 1675 1675 1676 1678 1689 1692 1696 1707 1710 1713 1720 1730 1731 1739 1740 1740 1741 1744 1747 1749 1750 1752 1753 1753 1758 1770 1771 1771 1771 1773 1774 1779 1781 1786 1788 1790 1790 1791 1793 1804 1806 1806 1810 1820 1823 1823 1827 1844 1848 1850 1852 1853 1857 1859 1860 1867 1868 1868 1871 1872 1877 1878 1884 1887 1899 1899 1899 1901 1904 1905 1905 1908 1910 1916 1919 1919 1923 1928 1931 1934 1936 1938 1944 1951 1953 1965 1965 1967 1972 1981 1984 1988 2000 2002 2005 2009 2012 2012 2012 2014 2015 2018 2020 2022 2023 2023 2029 2031 2035 2038 2041 2043 2046 2047 2051 2051 2064 2068 2080 2080 2081 2089 2104 2112 2112 2113 2117 2117 2121 2122 2125 2128 2128 2130 2135 2140 2142 2146 2151 2158 2159 2163 2164 2166 2169 2170 2174 2175 2182 2183 2194 2195 2196 2204 2215 2222 2225 2225 2226 2227 2227 2230 2234 2241 2243 2245 2249 2250 2253 2275 2276 2279 2280 2282 2287 2287 2293 2295 2298 2302 2303 2309 2310 2311 2312 2314 2321 2321 2342 2342 2342 2353 2354 2355 2358 2358 2362 2367 2388 2389 2390 2396 2397 2399 2400 2401 2408 2408 2410 2411 2415 2416 2420 2423 2423 2424 2424 2440 2449 2454 2457 2457 2468 2468 2470 2471 2495 2498 2498 2501 2503 2505 2509 2511 2514 2516 2517 2521 2523 2523 2525 2528 2536 2536 2538 2547 2548 2553 2553 2555 2569 2572 2572 2595 2596 2596 2604 2608 2613 2620 2624 2626 2629 2629 2629 2631 2633 2640 2649 2651 2651 2652 2653 2664 2664 2666 2675 2681 2684 2695 2707 2709 2710 2711 2719 2723 2728 2730 2732 2732 2735 2739 2744 2764 2766 2767 2768 2776 2777 2788 2792 2794 2794 2794 2798 2803 2810 2810 2811 2812 2825 2826 2831 2836 2840 2845 2847 2875 2881 2882 2882 2892 2893 2893 2897 2901 2902 2904 2907 2907 2913 2922 2923 2923 2924 2925 2925 2931 2939 2946 2968 2972 2995 2996 3003 3003 3006 3008 3008 3010 3012 3017 3022 3025 3028 3029 3029 3030 3035 3035 3038 3039 3040 3044 3052 3074 3081 3100 3102 3109 3109 3109 3110 3125 3134 3136 3138 3140 3143 3145 3148 3153 3155 3157 3166 3167 3171 3173 3175 3176 3194 3196 3199 3202 3212 3222 3237 3247 3247 3249 3251 3253 3256 3258 3268 3268 3270 3274 3295 3299 3301 3303 3304 3309 3313 3315 3318 3322 3327 3348 3350 3350 3366 3379 3383 3384 3389 3398 3398 3402 3405 3408 3412 3414 3416 3431 3437 3441 3446 3446 3451 3455 3463 3469 3494 3511 3511 3511 3515 3517 3520 3526 3529 3536 3540 3542 3545 3546 3550 3559 3559 3564 3568 3574 3597 3597 3614 3628 3630 3639 3641 3642 3649 3651 3654 3657 3657 3658 3672 3673 3674 3683 3687 3698 3699 3712 3727 3743 3750 3752 3755 3756 3761 3769 3770 3771 3786 3787 3800 3804 3811 3813 3814 3820 3827 3853 3870 3870 3871 3874 3874 3875 3883 3886 3899 3903 3913 3924 3928 3932 3940 3948 3961 3974 3976 3985 3987 3989 3996 4016 4018 4023 4027 4031 4033 4033 4053 4060 4061 4074 4075 4089 4102 4104 4124 4126 4132 4146 4146 4148 4148 4160 4161 4163 4173 4174 4181 4189 4203 4217 4239 4245 4247 4247 4263 4271 4274 4276 4276 4288 4302 4304 4311 4316 4326 4328 4342 4362 4373 4376 4389 4391 4399 4399 4403 4410 4419 4419 4425 4439 4456 4463 4476 4488 4500 4518 4525 4528 4532 4538 4552 4557 4562 4582 4589 4591 4615 4619 4651 4651 4653 4665 4672 4676 4681 4704 4710 4718 4750 4754 4766 4775 4778 4791 4809 4821 4823 4835 4853 4865 4867 4878 4890 4906 4922 4922 4954 4963 4966 4968 4993 5019 5021 5025 5053 5053 5076 5081 5118 5124 5138 5152 5156 5168 5175 5221 5225 5237 5255 5267 5278 5324 5324 5334 5370 5391 5421 5423 5427 5478 5520 5526 5577 5623 5680"
    print(linear_score("GPVGDVYDGRHHDTFKTRNIWSPDDFQVEQLMKLIGFAGTDYQLVCHSVC", [int(x) for x in sp.split()]))
    sp = "0 71 71 87 87 97 97 97 97 97 97 99 101 101 113 113 113 113 114 114 115 128 128 128 128 128 129 129 129 129 131 131 131 137 137 147 147 156 156 156 156 156 156 158 163 163 163 168 170 186 186 194 198 208 210 211 212 215 215 226 227 228 229 229 243 244 244 244 245 253 253 255 257 257 258 258 259 260 260 262 268 269 277 284 284 285 286 287 291 293 293 299 307 308 310 319 326 331 333 333 340 340 341 341 342 343 345 346 350 357 358 358 358 364 366 371 371 372 373 373 374 382 383 385 387 388 390 406 412 414 415 417 418 418 424 424 437 443 446 447 448 455 455 458 459 459 463 464 468 469 470 470 470 471 471 472 473 477 486 486 487 489 495 496 497 499 502 503 514 521 521 527 530 538 543 544 544 546 546 547 551 556 565 571 571 575 576 577 583 584 586 587 592 599 601 602 602 608 609 610 615 618 618 618 624 625 626 626 627 627 627 634 634 635 651 655 658 662 663 672 672 674 676 677 679 684 685 699 700 702 706 707 712 714 715 715 721 723 724 730 730 739 739 743 747 748 748 752 755 755 755 759 762 762 764 765 765 773 774 782 783 790 804 805 805 810 813 816 818 820 821 828 828 830 830 830 831 835 842 843 849 849 852 861 861 861 870 876 879 879 880 884 886 887 893 895 902 909 911 911 915 915 917 917 918 918 920 920 925 929 942 944 944 953 956 958 960 961 963 973 974 976 980 986 989 991 992 998 1007 1008 1008 1012 1012 1013 1015 1016 1017 1017 1017 1024 1026 1040 1043 1045 1047 1049 1051 1057 1070 1072 1072 1073 1073 1073 1073 1074 1081 1081 1083 1087 1088 1089 1094 1105 1105 1109 1109 1113 1120 1121 1126 1126 1128 1130 1145 1148 1148 1153 1160 1165 1169 1170 1171 1171 1171 1173 1175 1176 1180 1180 1184 1186 1201 1201 1202 1206 1207 1210 1210 1210 1218 1219 1223 1225 1228 1229 1233 1235 1237 1243 1252 1262 1267 1273 1278 1281 1282 1283 1284 1286 1288 1289 1289 1294 1298 1299 1302 1308 1311 1316 1319 1320 1327 1331 1332 1334 1338 1339 1349 1349 1356 1357 1357 1366 1366 1375 1380 1380 1381 1381 1386 1386 1391 1391 1395 1397 1399 1425 1429 1436 1437 1439 1439 1444 1444 1445 1446 1447 1450 1453 1455 1457 1459 1463 1464 1467 1468 1477 1486 1488 1488 1494 1494 1505 1509 1512 1513 1520 1524 1526 1533 1536 1538 1538 1542 1542 1542 1543 1544 1553 1564 1572 1576 1578 1578 1581 1583 1591 1592 1595 1595 1600 1602 1604 1615 1622 1623 1625 1625 1634 1635 1635 1639 1639 1640 1644 1649 1651 1652 1665 1666 1672 1679 1680 1691 1692 1698 1699 1699 1704 1706 1707 1709 1719 1723 1728 1730 1731 1732 1735 1736 1736 1737 1751 1753 1763 1778 1779 1781 1781 1786 1790 1793 1795 1798 1803 1805 1808 1810 1811 1819 1822 1827 1828 1832 1833 1835 1835 1835 1837 1850 1855 1860 1864 1865 1877 1878 1891 1892 1892 1893 1895 1903 1907 1914 1916 1922 1924 1926 1932 1935 1936 1936 1937 1942 1950 1950 1957 1958 1961 1963 1966 1984 1988 1989 1990 1990 1991 1993 1996 2005 2006 2007 2013 2023 2028 2029 2034 2035 2037 2050 2059 2063 2063 2063 2064 2070 2070 2071 2080 2082 2086 2090 2099 2104 2104 2113 2118 2121 2121 2122 2124 2124 2125 2136 2143 2146 2147 2150 2151 2160 2160 2169 2177 2179 2193 2196 2196 2198 2198 2199 2200 2201 2201 2210 2218 2222 2226 2235 2242 2249 2249 2250 2252 2253 2267 2274 2274 2274 2278 2280 2283 2290 2295 2297 2298 2306 2306 2307 2316 2319 2328 2329 2332 2337 2346 2354 2354 2355 2357 2361 2362 2366 2381 2381 2387 2388 2394 2403 2405 2406 2408 2408 2408 2411 2429 2437 2444 2453 2453 2453 2454 2457 2458 2459 2482 2482 2483 2484 2493 2495 2500 2501 2502 2505 2509 2517 2518 2529 2536 2537 2541 2542 2550 2550 2551 2564 2572 2581 2584 2585 2610 2612 2613 2613 2614 2614 2615 2615 2616 2623 2639 2646 2647 2647 2651 2655 2661 2664 2665 2665 2668 2669 2672 2685 2698 2712 2726 2728 2741 2743 2744 2744 2748 2752 2752 2752 2761 2766 2770 2771 2772 2775 2777 2779 2793 2796 2800 2811 2814 2823 2824 2825 2825 2845 2856 2858 2872 2875 2876 2880 2883 2884 2894 2900 2901 2904 2908 2908 2908 2922 2924 2924 2943 2952 2952 2953 2956 2959 2973 2979 2981 2988 2997 2997 3001 3005 3019 3021 3029 3030 3031 3036 3039 3045 3071 3072 3078 3080 3084 3085 3087 3102 3108 3110 3110 3116 3116 3116 3122 3133 3137 3144 3153 3158 3159 3160 3167 3168 3176 3187 3213 3215 3216 3223 3230 3234 3236 3241 3241 3247 3247 3250 3257 3266 3269 3273 3274 3284 3287 3289 3290 3323 3323 3331 3344 3344 3346 3354 3361 3370 3370 3371 3378 3379 3379 3397 3397 3402 3402 3403 3415 3418 3420 3445 3455 3460 3467 3474 3479 3499 3499 3502 3507 3509 3516 3517 3526 3526 3526 3531 3533 3534 3568 3573 3576 3583 3587 3608 3623 3623 3628 3630 3630 3631 3646 3654 3655 3663 3663 3665 3673 3686 3696 3712 3724 3734 3736 3743 3743 3755 3760 3761 3779 3784 3787 3792 3794 3794 3825 3831 3833 3840 3840 3849 3852 3861 3874 3892 3899 3908 3921 3923 3930 3932 3941 3941 3950 3953 3971 3981 3989 3996 3996 4005 4021 4031 4036 4037 4052 4054 4060 4093 4097 4109 4118 4127 4127 4133 4134 4150 4152 4159 4166 4167 4189 4194 4210 4240 4246 4249 4263 4264 4264 4279 4281 4281 4283 4288 4317 4322 4347 4350 4378 4378 4392 4394 4395 4396 4396 4410 4416 4418 4451 4478 4479 4491 4507 4507 4509 4517 4533 4539 4552 4579 4604 4604 4607 4607 4608 4622 4636 4654 4680 4689 4703 4735 4735 4736 4736 4737 4751 4751 4760 4836 4848 4852 4859 4864 4865 4865 4866 4882 4949 4965 4979 4980 4993 4994 5022 5022 5077 5080 5094 5109 5122 5151 5178 5206 5208 5223 5237 5280 5307 5334 5337 5338 5409 5435 5436 5465 5524 5565 5566 5621 5680 5752 5777 5908"
    print(*trim("""GTHMACFWICQWAPYVPPNAVVIANPGRFQHRYDMHEKVCYLCYLYA IHQEIPFRWDYTTLEGWRRPPWPCCHNLIHWGHGTLEYIYEKPEMDV GTHGISGEPFQWIDQFMVCVGSVPYRGKRNMEHGAWIMDKDGCGMGT VPLVAENFLSRGDYSHNKLADYQSRMSIWFMFFLPTIVQTQQASIDS TDFMLPALSMGFKGMLHPRDTNWNWMKSPVLECFHIQYWRAKYRYCV QLPGNTGENRFCEYYAELLTDTGDKIAVTRNTFSDHRLKVPRILARL WAHRHKAQVMREYLPVWPKFLPATYVYSEEMLEWNSWQTHIGKQWNK IAPCSLCRYGMWMGKITQQIQCDVESHLQNNPDVKIEPTVRHPTTTS SELMRATPATKPPPVHGFDFELGDSQGPCEQSLACEDYSLIQYQRSR WFHKQNHHVIDRCKGACHCDTWIETSQILLYHWEQCPEGPVYNLYVQ RKNNFCGRWNSNPCNAFITALIYKIMDQRTCYTHFIVDKANQAYARP WMKEVHIGCFHYTMNDWARVFCPFMGVWAMPYIWFNRCKQDITQPYE HNRWVDSMQTYHPINAVMWKAHLIQNKEGDPTTVPQHWKKTVHDLDV IMLCMYGWIDWGIIQIRLFFPMLPVCDELQMVGQFARDIWMMATWTD ESQYMFFMMLKLWIHRYSTESMLTECMIHWEGPEMHSIMWWDCMVST VQCVGDAAIHPYRTFPSQCDCHKKHTHGQQRRCTGRSISHLGSNQGW NGVNFEKASRIVAHQFLSYEHARWWNGRHVTKDERGDTNKIAVGMAE EVMSKVQMPVELQQHYEGCNAQPEMYVHHMELVPTHQVCYENMGCAA""".split(), [int(x) for x in sp.split()], 6))
