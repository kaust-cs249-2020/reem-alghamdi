"""
@BY: Reem Alghamdi
@DATE: 18-11-2020
"""


def data(bw_text):
    last_col = [(bw_text[i], i) for i in range(len(bw_text))]
    first_col = sorted(last_col)
    last_to_first = [first_col.index(i) for i in last_col]
    return first_col, last_col, last_to_first


def occurrence(last_col, symbol, top, bottom):
    top_index = None
    bottom_index = None
    for i, tple in enumerate(last_col[top:bottom + 1], top):
        letter, pos = tple
        if not top_index and letter == symbol:
            top_index = i
        if letter == symbol:
            bottom_index = i

    if top_index:
        return True, top_index, bottom_index
    else:
        return False, top_index, bottom_index


def burrows_wheeler_matching(last_column, last_to_first, pattern):
    top = 0
    bottom = len(last_column) - 1
    while top <= bottom:
        if pattern:
            symbol = pattern[-1]
            pattern = pattern[:-1]
            flag, top_index, bottom_index = occurrence(last_column, symbol, top, bottom)
            if flag:
                top = last_to_first[top_index]
                bottom = last_to_first[bottom_index]
            else:
                return 0
        else:
            return bottom - top + 1


def solve_burrows_wheeler_matching(string, patterns):
    first_column, last_column, last_to_first = data(string)
    count = []
    for pattern in patterns.split():
        count.append(burrows_wheeler_matching(last_column, last_to_first, pattern))

    return count


if __name__ == "__main__":
    # print(data("smnpbnnaaaaa$a"))
    # print(burrows_wheeler_matching("smnpbnnaaaaa$a", "ana"))
    # print(*solve_burrows_wheeler_matching("TCCTCTATGAGATCCTATTCTATGAAACCTTCA$GACCAAAATTCTCCGGC", "CCT CAC GAG CAG ATC"))
    string = "CGTGTATTCTAATTCGAAATGAGCCGGGCACCCACCATTTCGGTGCCTCGCGGGCCCTGCACCTGAACCGCTGCGTTAAGGAAGCCATGGGGGCTTGTTCGGCTGCTCCCGTGATCATTACGTGGTGCTAGCCACGTGGAGTCATTGATATTCAGGGTGGGTGGAAATACGAGTAATTTGGGGTTGAGTCCCCTGGATGCTCACTATCCCTCTTACTGTGTCAAATTCCCACCGTCTACCGATGCGCTCGGTGAGCTGCCGACGGCAATGCGTGACGGCCCTACCTTAAAACTGGTGACACGGCGATAGATACTTAATCTGTAGCCTTGACTGAATCAGAAAGGCTGGTCGTATGCACTGCACCTATTATATACGAAACGTTCATCGGATTTTAATCCAAATATGGGGATTGTCCCGGCAAAATACTCGGGCAACCGGGACCAATGCCCTATTGGGCTGGTGACTTGTGCATGAAACTGTCTAACGCGTACCTGATATCCGATCGGCTGCTAAGTTACCCTTGGTCAAATCTCTATCGGGTTGCACTCACAAATATGACGATTGGGTGCTGGTTTAAGTGTTACCTGTCTGGTACGGAATTCTTCTCACTTTTCGACGTGTCAGTCCGCATGCAGAGTATCCTTTCGGAAGCTATAAGGTCACGATCATTTGAAGGAGCCTTTAATTCCAAAAGCGGAGAGGGACCTCACTCCATCTGAATTTAGAAAGCACCTAAGGTTGATAGGGCAAGGACCGGCATGAGGTCGTGAAA$ATCGCCGGTAGAGATAGTCACTGGGTCCGGCGCACCATTGTGTTGCTACGATGAAAGCGCGTGATATTGTCCTCCGCGGGGTCCTGAACCGAAAGGTATGTTCTGTACCCTAGTGTTCTTACACTGCTTCTCCTACAACCAAGAGTGGATATCTGATTTCGCATGAGCCTCTCCTATTGTTTCCGGAAACATGTCAATCTCTTCAGCTTTCCATCGGCATTCCGGTCC"
    patterns = "TGTAATGAGT ATAGAAAAAT CGGAATTGCG TAGGGGCGGA TGTTCACGGT TCGTCCCCCG GACAGCATCG GCCACCATGA ATGGTCTTTG ACACTTTTGT AAGTAAACTA GTCGCACATT CACGTAGTAC CCGTCATGGG CTCGCCCCCC CAATACGATA CTGAGCTGTG CAAGTATTCA CCGGCAAAGA GCGTGATAAG GATTGCTACA CGTCGTAGTT TCCGCCAAAC GTCCGCCAAG TCGATCCGAA TAAGCATAGT ACCCTGTACG TTCGTATAGA TTACCCACTT ATTCCTTGCC CCCTAGCGCG GTCATTGCCC GACGACGGCC CTTATGACTG CATCCCCTCC TACTCAGTTT AGCACGGTTT CATTACTCGC CCAAGCTTAG TTGATTGAAT TCCAGATTCT TAACCGGCCT AGATAAAGAT ACGAGGACCG GCCACCATCG TGAATGTTGT GTGAGTGAGG ATTAATCCTT GCGAATGATC TATCTACGAG GGCATCTACT GCCAATGTTA GGCGACCCAA ACGTGAACGC AGTTAACGAA CCTATACTCT CGGCGAGACA GTATAGCCTT ATGTTAGTTG AGAGTGATAG GGGATCAGGT GATGGAGAGA CGGACCCGAG TAATGCGGCG CGATAAGGAC TAGCCTCGAA CTTCCCTGGC AATACGATAG ACTGTGGGGT GGGTATCAAA AACGGCTCGT TTCACCCAGA GACTGCCCTG ATAATCCGAG GGATGGTTGC CTTATTAACA GCACTATAAA GCTGCAACCT TGGAGGACGG AGCTTAGGGC ATGTGTCACC CGCTGAGCAG AAGGATCTTC GGCAGGGTCC CCGCTAATAC TAAGAATGCC AGAGGACAAA AGATAGACTC GAGCGACATT GCGTCCTCAC ACATCGCTGG ACCCCTACTA GTGTTTCTCC ACCCTCGAGC GTCAGTGACA GACCTGGAAA GGCGAGACAT TTATGGCAAC TTAGGACTCG TACAAACAAG TCAGTCGGAC AAAGAATAGA CATGACTGCT TGCTGTGGAA CTCGGGACTG GACCACCTGA GTTAAACCAC ACCATGATAT GCACGAATTG ACATCGTACT GAGTCCTGGG ATAACCGCCA ATTATATTTA GGGTTCAACA TAGGTCGGGT CGGCCGAGGC TCTTTGACCT CTCTTGGGGT CTCCTTTCTA TGGAAGTCGC GAGACATCCC CGCGTGCTAT CTGACCACTG AGTAGGCACA ATAGTATCCC TCTACTTATG GCCAACAAGG CTTGCTTGTC CGTATCAAAG CAGGACTTCA AAATAAACCG GACTTTTGCC CACCAACGCA GTACTCATTT AATGGAGGGA CGAAATGAAG GACGGCCAAT TCCATGGACG ATTTTTATTA AGCCGGTGCG TCGAAGCACT ACAGACATTC CCAATACACC GGGGCACCGT GGGAAAGGTA GTCCCAGGGC CGATGACAGG TAGGTACTTG ATTGGCATCC GATATTAAGA GCCCCGGCGG CCGGATCGGA GTCCACAAAT TCGGACCCGA ACCTGCCTGG TGGTGGGTAT TGGGGCTGTC GACCCAGGTG GCTTCGAAGT TTTCTGTACC TGCACCCAAG CATAGAGTCG CGTTGTCTGT TGTTCTGGAA GCTTGTGTAT TCACAAATGT AGGTTGCAGA AAGACTCAAA TCGATATTAA CACTTACTGT GTGGCGAGTC AGTCTCCTTT CCACCATGAT AGACATCCCC CACGCTGGAG CCTAGTGAAG TAAGTACTTC CCGTCTGAGA TGCGGCGAGA TTTTGGTCGC GCTGGACTCA CAGTAGCGTT GCATTTACGC CTTGCGGGGA ATTCGACATG GGGTATGGCT CTAACAAACA CCTAGAGCAC ACTCTGAAGC CACCCAAGTT CGCGGCCGAG CGCTTGATAG GACCGCCCCA TCTCTACGGA ATAATGCGGC TGAGGTGCCC AACGGATGTG CACTGCGAGC CCAGGTAACC TTCCGGAACT GCTCGGTAGG AGACCTCGAC GTCTCTTTGC CTTTTCCGCG TCCGTCATGG GACATCAAAG TGATCCAATC GTCTAGATAT TAACGTGATA GGCTCTGGGG CCTATTGGCC GACTACAAGA GGCAAACGAC CACGGGCTCG CTATATAATG AGATGCCAAT TAATTGAGAT TTGCCCTTTT CACCAAAGCG CTTACACCCC GAGCTGCTTA GCTGCGTTCC TCTAAACGCT CCCCATCCTC TTTGGGCAAG GTTATCAACC GGCCAATACG TTTATGTATG CGTGCGGCTC AAGGCGCCGG AGTCACACAA ATCGTGACGA CCCATCGACA TTCGCACTTA CCCAGCACCG GGCCTGCCTT GTTTCGAGCG GACTTATATA CCCCTCCCCA AGGGAATTAC TACCGTTTGT GTGCGGCGCC GAGCTCCCAC TTCCACACCA CAGCCACGTT TGCCACCATG CTCGCGTTGA TTACTGGTAC CTGTTCACGG AACGGTCCAG GACCCACACG TTGGGCAAGG GAACACTTTC TTCTGATGGG AGCACTCAGC TGTGGGAGTG AAAAAAGGTC TTGCTTCGAA TCATTTCTGT AGGCGGATAA TAAGGGTCAA GGTAAGGCCC GTCCAAGCCT AGGTGTGCTC GGCACGGGTG TGTTAACAGG TGCAGGAACA ATTACGCTTA TGGGGATCGG GACCTGCCTG CAAGTTAGTA AGACGACGGC CTTGATTATC TTACGTAACG AGGTAACCGA GGTGAAGTGA TTAAAACGGG GCCCCATGAC TCTCGTATAG TATTGAAGCT ACCAAGAGAA ACTAAAATAT GTATAGGGGT ATCAATAAAA GAACTACCTA GTAATCCGTT GATGCATATC CGTCAGGAGC AGTGATAGCA TAGAATCTCA GAACCGCCAT TCCCTGGCTA GAGGCCACGC ACTGTCCCTT TGGCTGGAGA TCGGGAGAGG TCTAAGCGGG ATCTTTCCGC GGCGGGCGGA AAAACTCTGC ATTTATAATA CACACTTTTG TACTCATCAC ACTCTCTGGT TTCTACTTGA TACTGTGGGG ATCTACAGAT GACTTTCTCC TCGGGTAGCC CAGGCTCTCT TGGGAGATCG GGTGCGCAAT CCCCATCGAC TACGATAGTA CCTGCCTTCC AGGCGTGAGG TCTACAGTTT CAAACTTCCG TGAAAACGCT AGCGCTTAAT GTTTCGAGTT CATGCGGGCG ATCATCTCGC GCATTCCAAC TCGCGGTTGT TGGTAGGGTA ACGACGGCCA CTGTAATGAG TCCGTCATTG CTCCTCCCGC CCACTCAAGA TTTGTTCTGG CCGTGTCACC GCACAGGGCG CAAGTGTGAG GGGTTTGATA GATCTCAGTG TCCTGGGCCT AAGTGGACCC CTACTTGATT AGTAGGCAGC CCTTTGTGAA AGTCTTGGGC GACCTCCAAA CCAGAAGGTA CAATAATGAA GGTAATTGAC GGACTCAAGT AGGTACTTTT AGTAGAATGT AAACGCTGAG GCGACATTTG ACAATATCGG GCGGATCGGC ACGCACACGT ATGAGGTCGT GTAGGTCGGG GTGTGAGCGA TGTCAACAAT ATCGCATGAC TAACGCCATG GCCGTCTTGT ATATAATGCG GTATCGCATG AGCTGGGGCG TACTCTTCGC GGTCGGCTGG CCCATGACTT CGTAGTGGTT CTTTAATCGT GGACAAGCCT AGGGAATAAC GCTATGTTCC TAGAGCACAC AAGAAAACCC GTAGTACGCA TTGGGGTCTT CAGCTTCAAA TAAGAGATCT CAACGCGGCC TTTCGGGTCA ACTCCCACTG CCTTTTTGTT ATAGTCTCTT CCGAGGGAGT GTATTGTCCT CAGGGTCATT CTTGGGGTCT TGGTGAATTC CTTTAATACA GTCGGGTAGC TTCTGGTTTT CTCGGGCTGT GCTTTATGTA TAGACCTCGA CTAGTATCAA CACACGCCTG GTTGTCTTTG GGCGTTAAAG ATGCATTCGC GCCGCCCCCA CCATGTACTC TCGAAGACGG GAGTCTTTCC ACTCGATCTA CCTAGGATGT TATGCCTAGA CAAGTTGCAC AAAGAACTTA AACCATGTAC CGGGGACGTG TTCCCTGGTT GTGTATCGCA CCTAAGCACA GGGCAAACAC GATAGTAGCA TTAAAAAGGG TAGCGTTAGC CGTCACGGTT GACATCAACC GGTACTTCCG CACAAGTTTA TTGCGCGTGT CCCAGAAGGT GGCTCGTTGA CGGGGATTGG GCACCGGTAG CACGACCTCC CTCATAGTTA ATAGCAGAAG CGAAGGCGTT CAGTATGCTT AGGGGAAGAC CCCTTCGTGG AGCATTTGCG TTTCCCAAAT CGCGCTGCGC GCCTGCCTTC AGGAGGCCCG CAAGGATCCC ATTAAGACGT TCGACCTGGT GGCCGAGGCC TATAGAGTCT GTGTATGGTC ACGTCCAATT GCGGACCAGG GAAATGGGCA GACATGGTCG AAGACAAAAC ACCCGTTCCG TTCTCCACCA AACCGTAACC TAATTGGCAT GAGCAAATGA AAGCTTGCGA AGGCAAGCAA TTGCTCGGGC GCACTTTTCC CACTCCTTGG CCATGGACGT GGGTGGAACT GTTATTGCCA GGGAGTCCAA AGATAGCCCG CCTTTGCTTG AAAGCCAATA CGCGTCTGTA AACGCATAGT TGCGCCAGGG TTCTAGTGCG GCCAGGTAAC ACAGCGTGCG CTCAGCTGCG TGTTATTGCC CAGCATAGAT GACCACTGGT GCGGGTTCTC ATACGATAGT TGACATAATA ACTGCCTTGC ATGGACACAC TTTCTCCACC TAGTTATATT CTGCGTGGGG CACTGGTAGT GTCTTTGACC CCTGGCTACT TTGGTACTAC GCGGACCTTC AGGGCCATGA GACTGCTTCC TGAGCTCATA CCAAGCTTTT CCCCGCTCCA ATGAGTCTCT AGTACCCGAG CTCCTCAAAG AGTAGCACCT CTGTCGTATG CTGGCGTATC TACGTCATAG AAAACCGACT AGGCTTTCTT AGGTAGGTGA TGTCACCTAG ACATCCCCTC ACATTTGTCA AACTAGGGCA GTCTCTAAGA CAGAGGACGT CCAGAGTTTG CTGCGAATTC AAGAACGAGG CCTCGAGGAC GCTTGATAGT CTTATCGGCG GACTCGCTGA CTTCGAAGTA CACTTATGTT ATGACTGCTT GTAGTAGACC GTTCGTCTTA TCTCCTTTCT AAGACGTGAA GGTCTTTGAC TTGATGGCGG TTAGAAGTGG GGGTCTTTTT CACCAAGCTT TCTTTTCATA ACATCGATAT TGATGTATAG TTGCTGTGAT TAGTAGCACC TGAGTCCTGG TGAGGCAGAG TAGTTCAGAG ATCAAGATGA CTTTATGTAT TACGGTACGG AAGATAAAAC GACAAGATAC GAGCACTCAG TGACGTGAGT GGATTCAGTC GAACCTCCGA GATAGTGAAA TGAAAAACAG CGAGCAGTTC TAGCCATTAA AGTATGACCC GCTATATGAG GACTCAAGTA GCGTATCCGC AGACCCCGGA CAAACCAAGC GACAAAGTTA GATTGTGGTA TCTGTGCAGG TTTCTTGCTT GCTCTCTCGT TCATTGCTGA CAACCTTTTA AGGTCGTGAC TTGCTTCACC TCCGCGTGCT GCAGTCAAGC AGGCTGGACT CGGTTTGAGC TAGCTCCTTC AATTCCCGAA CACGGTTTGC ACGGGCTCGG GAGTTTTGAA CTCAGCGCTA TATAATGCTC GACCACCACT TTCCTATTGG GAAAGCGTAC ATAACTAGTT CTAACCCTGC TCTCCACCAA TTATAACGGA TGGCCATGTG TAGGCAGAAC ATGGGCAGCA GGGATGCGTA CTAGGTCGAT TAGTAATGTC CGATACGTTC GTCGATAAAT GCTCGAATCC GAACGCACGA GGTCGATAAA ACTCATTTCT TGGGGCGGAC GGCTACTCTT TCTGGGGATC CTATCTTGTG GGCGTAAATG CTCCCACTGC GCGAGACATC GGCTTTGGGG TTGGTTCATT GCAAGGCTGG GAATTTACTA GAATAAAAAG GTGATAGCAG CCACGGGCTC GTTGCACCCA CCCCAAGGGG CCGTGGCTGT TGCGAGGTGA GAGATAGACT TGTACCTGAC TACGTCATTG TCCGACGCTA GAACCCGCCC TGAATATTGG CGATTTGGAT ACTGATGCAT AGAACGCCAA ACGAGGCGGA TACAGCGACG GGAGTCCGAC TGCGTACTTT GACCACGGTT CGAATCTGAA CTGGTCAACA AAAGAGTACA CCCCTACAGA TTCCGCGTGC ACCAATACTC CCCTCGTACC GGAGTTGGTA CAGCCTTCCG GGGGTCTTGG GGCCATGTGT GCTGCCTCCT CTGTGTACAG GTCAAGAAAC ACACAAGTTT GATATGCTTT CGGATTAGAC CTCGGACTAT AATATGTACT GGACAGTAAG CAGTAGGTCG GCACCCAGAA ACTGAACCTT CATTTCTGTA GGACTCATGG TTCTGGAAAC GCCTAGAGCA ATTCAACAGC AGTTAGTAAC GAAATTCAGT GAATTGCGCG TCAAGTATTC CGCGGGCCAT GAGGCCAGGT GTAACCGGCC GTCGGTGTGA CGACACACTA GTCTTGGACT TTACAACTAT TCAGCAAATT AAAGCCCCAA TGCAGTAGGT TTAGGAATGA ACCGAGTTAT GGATCGGACC ATTGATGTTC CCATGATATG TCCACCAACG CGTCATGGGG CAGTGCCTCC AAGGGCATGA CGCTGTGTTA CAATCCATGC GTTAAGCCTC CATTAAACAC CTCAAGATCA TAGTACCAGT GGCTGGACAT TCAGCTGAGA ACACTATATA AATCGTGCAA ACCCAAGTTA AAGGTACTTT GGCTCGGGGC CAGTATCCTG CTCTCCCATA GTGACGCCGG CTGACAGCAT TTGCGACTAA TTCCAAGTAA CTCAAGTATT TATGTACTCA TCAAGTTGCA CAACAAGTAC GATGGTACAG GAGCAGCGTC CGTGACGCCG CTAAACCTGA TTACGGGAAG ATCTACCATT TGCTTCCGTC GACGCTATAT ACTTTCTCCA GATCGGACCC AGCAGCTTAT TAGGAGTCCG ACGGTTTGCT GGGTTCGCAG TGCTTGTGTA AAGTACCCGA AAGGCTGGAC TAGAGTGATA GTTTGCTTGT AATGCGTGCT TAAATTTCCC TGTGGCACGT GTTGGGGTTT TAAGTCCCTG AGCACGATTA CGACTTGACA ACGCCGGATC CTTGGCGGTG CGGACGGGGA AGGCCAGGCA CTCGTTCCAA AATGCTGGAG GCGCTCTAGT CCTGCTCTTG GTCTCCTTTC CCTAGTCCGC ACGTCATTGC CTTCGCCCAT CTACTCTTCG CCTGCCTGGA ACTGTGAACG TACCACTATA CGCTGACCTG ATTTGGATAG CTATATGGCT GTTAAACGTA CGTGAGTTGC TGCAGATTGC TGATTCGTGG GGCCTCTGTA AAGAGCAACG CTAAAATATG CTGCTTCCGT CAGTAGCATG CCGACGCTAT TGCTTTATGT GAAGGTACTT TCCATCCCGG TTTAATTAGG GGCTTTGAAG AAATAGGACA GCTTCCGTCA CTGCCTTCCC GGGAAGTAAG AGGGCCTTGT CAAGATACGC CCGTTCCAAC AAAATATGTA ACTTGATTAT GTCCGCTTTG AGCCGGTCGA CGAAAAGCGG CGCATGAGGG GAGGCGGAAT AGTGAAAACG CTTGGACTCC CCACCAACGC AACATTGTGT CGGTAGGAGT GTGGTCGGTT CAAGTAAGAC TAAACGCTGA GTGTGAAGTC TGATAGCAGA GGAGCGAGCC GATAGCAGAA CACTGCAGTA AATTGTGCCA CTGGCGAAAT CTGTGTGACA CTCCCTCCCT CTTTGGGCAA TAACCGACTA TCGTCTCCGT AGCGGTGTGC GTACTGGTAA TACCCGAGGG CAACCTAAGC GAGTCCAATA CATACGAGTT GAATCGGAAC GGGTCTTTAA CGCCGGATCG TTGGCATCTC AGCGCTCCGC CCGCGACGGC TGCGGTAGCC ATTATCTACG CGATCACCGC GGCTGTTCAC TGCAGTTCGG TAAAGGACAA CTCCCAACAT TGTTTCGGCA TGGTGAGTTG TTGTTCGGCG TCACACAAGT ATGGAAGAAC GACTCCCACT GAGGCCATTT GTCCTGGGCC CATTTGTCAC CATTTAGTGT CCGTAAATGA GCCTCTGTAA ACAATAAAAA GCAGGAGTGA ACCTAGGTCG CTCACCAAGT CCTACGGTCT TAGACCAGAG ACCACTGGTA TCTTCGAGAG GCATCGATAT GTCGGGAGAA AGTTAAACGT TGCAATAATA AATACCAGCG ATGTGCCAGA CGCCCTAGGT TGCCTTCCCG GGGATGGTTT TTAAACGTAC GTGTTGTCAA TGACAGCATC GGTGTATAGT CTCCGCGAGG ACCTTAATCC CATCGACATG TGTGTAGAGG TTGACCTGCC ACGGGGAGTC GTTTGCTGAC TCGATGGAAA ATTCGCACTT AGCACCTATA TACCGGTCGG GCTTCAGTTA ATGTATCTAG ATAGTAGCAC TCGCTAGCGG ATCGTGATTC ATATCGCGTA TCGTGATTCT AAGAGAGTCC CTCCCCATCG AATGCTCAGG TTATGTATGC AAACTGTATT GCGCTGCGAG CCCGAGTCGG AGAGCTGGAG CGCACGAATT TATTGGCTTG TGTATTACGG TAAAATATGT ATTCATACAT AAACAACGAG AACGGTCACA ATGGGGTCTT ACCCGCGAGT ATGCCTAGAG GCTGTGTACT GCCACTTGCA TCATTGCCCT AGTTTAGAGT GTCGCAGTAC GATATGACAT CTTCACCAAA ACGGCCTTTC GTGGCTGAGA TGCAGAGCAC AATCAATTGC TGTGGAGGTT ACTGGAACTC CTTATACGTC CCCAAGTGGG AACTGGCAAG TTTAGATGGG ATCGGAAGTC ACATGAACGT TTATAGTATT TGCCCGGATG CAAGATCCGA GGGATCGGAG GCATTATCTA GCAGCTTATA GGAGGTAGGG AACCTCACTA TGAGTTTTGA CAGCTTATAC GCAAAATCCA CTTGTTGTCC CGATAGCGTG TTACGACAAA AGCACGCCGG CATCGCCGCT GCAGGACGCT TCGCTAATAT ATTTCTGTAC TCGCACCCAG AGCTACTCGA GACGGTTTAA AAGGATGATT TGGGGTCTTG GACGTGTGCA TCTGGGCGGC TGGTCGGCCG ACTGCCCTAT AGAAGGTTGC AATGACCGTC AGTTGCACCC ATGGGCCTAC CCTTAGCGCG GGTCTTTAAT GCATTACGAA GACACGATCC TTGTTATTGC CCTACGCTCC TCGAACGATC CATGGTCGGC GAATTCGTGC ATCTGACTGT ACAGATTTAA TTCCCTGGCT CTCTTCGCAA TTATTGTCAA GGAGCACTTT GGTAACCGAC AGGCGGAATT AAAACGTCTA TCTCGGTGGT ATAGTGAAAA ACAATCCCAC CTGTCACCGG AACCCATTCA GCGTTAGGAC GCTACGCGTC CCCACGGACG GTCACACAAG TTGAATCTAA CCCCCCTACA CAGTTTGCTG GCATTACGTT CGACTGCCTT ACAGGACTTT CGATGGTAAG TAAGAGAAGC AACGCTTGAT TGCGGCGAAG GCCTTCCCGT GGATCGGTTC CTGGCGGCAC TGGATGACGT CCAAACAACA GTCGCGCGGC TCGAAGGATC AGGCCTTCAT AGAAGGCATG GGGGTCTTTA GTACCTGACA TTTCTTCCGT TTCAAGTTGC AACATCTTCG CTTCCGCAGT CCACTACACA TGACTGCTTC ATTCCATTCA TAAATGGTGA GGTCACTAAG TGAATTCGGC GGATCCGGGC AGCCTTCCTC CATGGGGTCT GAGACCCACC GCTGAGCAGC TCGGGCTGTT TCACGGTTTG TAATGAGTCC TGCACTTCAC TCAACAACCC ACAGCATCGA TAAATTGTAA GGTTAACTGC AACCGGTAAT CCGCACTGTG GGCCCAACGG GACCACAAGT TCGATAAATA AGGGTGCAGG CGCAGTAGCT AGGTAGTTCT CCTAAAGACC GTAAACTCAA GGTTGCAAAC ATACTCTTCC GTACATGCTA GACCCACTGA AACGCTGAGC GCGAAGGATT CTACAAGGAC GCGCGATCCT CAGGGACTGT GGTCTGTTGG TGAAGTCGGC TAAGACGTGA CGCCTATTAG TCGTACGAGT TGCCCTTTTT CAACCGCAAC TACTACACGT AGAAGGTACT CAGCACGCCT GGCATATTAT CTCGACTGCC CTGGATGACG TCTGCCCCAT CGTGCCCGTC GCGTCTTTTC TTGCGTTTTC AAGTTGCACC AAAGGTGCTA TCGACTGCCT GGATCGGAGC AACTTAACTA GGCTGACAAG TAGATATCTC AATGGGACTA CTTGTCAATA CTACAACATC TCGCATGACT TCTTAAGGAG CCAATACGAT CTTGACGTAG GTTTTGCCAC ACGAATTGCT GAGCTAACAG TCGAACTTCA TGGAATAGTC TGGGCAAGGC AGACATGCGC TCATCGCAGG GGATGACGTG TGCTCGGGCT TACCCGCTAT TCGCCCCACT AACGCACGAA TGTCAGGAAA AGGACAAAGT ACTACCAAGT GATTCTAAAC AAAACGATCT CAGCGTGCGG ATAAAGAGTG TGACCTGCCT GGCTCGGTAG GTATTCAAGT GAGTATGCTG TGACGCCGGA GAGGTCGTGA CACCTAGGTC GTTAGTAACC AGGGAGTCCA CCGAGTCGGT CATGAGTCAC ACTAGTCTTG ACCCATGTCA CCTACGAGCT AGCCACTTCA CTATACGACA GCCGTCTATT CCTTCCTGCC AAGAAGAACC TTACAAAGAC GCTCGGGCTG GTTACGCCTT TGTGTATCGC CCGAACCAGC GAGGCGTATA TGATAGTCCG AAACGCTTGA TTGCAAGGCA AACCTTCAGC TGCGAACCCA GGGCTTTTGG GTAACAATGG TTATTGCCAC TGGTCTTTGA TGCCTCGACA GTTGCTTCGA GCTGTAACGC GGGGATTCCG ACTTCGACCA CGATGAACAG GTCTTTAATC TAACGTACAG GTGAACGCAC TATTTGCCCA TGCAAGGGAG CCTCGTTTTG GCCTCTCTAT TATCATCCAT TCTTAGATAA TGGCGTCAGA GAGACAATTT CGGGACTGGC TTACTGGTGC CGAAGAGGAC ATGAGGCCCG TATGTCGCCA AAGCATATTG GACCTACGAG GACACCTGGC TACTGCATAA ACTTTTCCGC GACGTCGCAC CGATACATGT ATAAAGTTGG CGAATGCGAT CCTTGTAGTC TCGGACCCAC ATCGTGCTAT AAAGGCTTCT TGGGTACTAC ATCGATATTA GTTGTTCCGT ACCCAGAAGG GCCAGCGGGA TACCGTCCTC ATGCTTTATG CTTGATAGTC AAGTTAAACG CACCTCTTGG ATTGGCCATG CAGCATCGGT AGTATATACA CGCACCCAGA GGTAACAAGG GACCAGCGCC GAAAACGCTT CAGTAAGCCG ACGGCCAATA GACCTCGACT ATTAGACGGA TGTATGGTCT TTTCCGCGTG ACGCTTGATA ATCAAGATCC AAGCTAGCTT CCTATCGCGT CGATGACTGG GTAGACCTCG TCTGGAAACC TTAGAGTGCC CTGGCACTAG ATGGTCAAAT CTTTTTGTTA GAACAGACAG TATGCGACAC TGTTCCACCG CTGGAGACCT TATAGTTATC GGCGGAGCCG CTAGCTGGTT TACTTGCTCT CTCGGTAACT TGCCCGTATG ACGTCGCACC CACCATGATA TTCGCTGGAC GCGAGCAGGA TAGCTGTCCC CACGCAAAAG TTCCGCGGCA GGTGTGAGCG GTATACTAGG CCATGAATAT GCAATGAATA GCAGAGCACT ACGTTCGGTT CAGCGTAGCT TATATGAGGT AAGGCAGGGG AGCACACTTT AATAGATAAT GACCTATCAC TCACCCTATA TTTTCCTATT GTGCATAGAT GTCGCTTTGT CACACAAGTT CTCTGTAATG TGACCACTGG AGCAATTGCG TTCGTGGCTC TCGAAGTACC GTCGGCCCAC ATGGCCCATA TGAGGCACCG ACTACATAAG TATGTATGCC CTCCTGGGGC CGCGTCTGGT CGTGAGTTTT GTCGATGTCC CTTTTCCTAT GATTCACGGA CCTCTGTAAT CACAGTATAG TCTAGTACTC CGAGTCGGTG GGCCATGAGT GTTATGCTCC TGAGCGACAT TGCGTTTTCG CGGGTAGCCA GATAGCCCCG CATTGCCCTT TGCTGACCAC GAAGGTTGAC CACGAATTGC ATATGTACTC CTTTTTACAC GTCCAATACA ATTTGTTGCT ATAGCATTGC AGTTGCTTCG TGTATAATAC TCGGTAGGAG GGTCTTGATT AGTTTTGAAG AAGTCAATTC TCCTGCCGTA CAATACACCT GGCTTGACGA GCGGCTCTGG GAGAGGTGAC AGCATGTTCA CTATTGGCCA TTTTGAAGCG GCGACACTGT CTGTGCCACT AGCGACATTT GAATTGCTCG ATTAACTCGA GGTAGGAGTC TCCGACTATT TATATAATGC GTACTCAGTT CATTCCTCGG TCTCCGAGCT TTTTCGTATA GGTTGCAGAG TGTGCCAGAT CCAGGATTCA TGGACTTTCT CTTCGGGAAG GCTAAGTTAG TGAGGTCGTG CTAATCGTTA AAAATCATAG AAGTTTAGAG ACAGTCGTTC GGTACTTAAG GGTTGCTTCT CGTTGAGAGA GGTCGTGACG TGCCTTTAGT TCCCGTATAT ACCCGGCATT CGTCTGTCTA TGGGACACCC CCAGTGAGAT CCGACTAAAA CCCCCGAAAA TGACCCCCAC TAGCCACAGC TAGCACCTAT TATTAAGACG GAGCACACTT ATCCATGGAC TTTGAAGCGA ACTTGCATAA ATAAATCTCC GAAGGTTGCA AGACGGCCCC GGAGCGTTAT GTTCGTTAAA GCAATGTGCC CCGGTGGCCC CCGTGAGGAA ATGACGTGAG CCTGGGCCTG TCACGGAAGC AGTGGAATAC CCATCGACAT GTATAGGGGA GTAATGAGTC TATCGCATGA TGGGCCTGCC TTCGCAATGT TTGTCACCAA AACCGGCCTC ACCAGATTAT ACTGCAGTAG CTAAACGCTG GCACCTATAC AATGTCTTGT TGACATTTAC TGTAAAGCGT TGAAGCGAAG ATAGACTTAG GCGGAATTGC ATCGACATGG TGCACTCTTC AGGAGGTGGA TAGGTGCTGA GCATTGATCG GTACAGTCCA TGTCGCAAGG ATTGCTCGGG CCACTGGTAG CCCCCTATTT AAGGACTGTG ATGAGTCCTG GACTAAAATA CGAGCTAAGT AACTCTAAGT CGATAAATAA ACTGCTTCCG TCTGGTCAAC TCCGGCAGCA TCCCACTGCA GGTTAGTATA CTTCGCAATG TGTGTATTTT AAGCCGTCTC ATATTTAATT TCAGTTTGCT GCCGGATCGG TAAAAGGTAT GTTAGCTTGG GGTCTTGGAC CTCGCGTATC TACTTTTCCT GGGCGGCAGC GGTGTGAACC TCTCGATCAC TTTGCTGACC CGCTATATGA GGAAACCATG TTGCCACGGG CTCACCTAGA GCCTTGCGTT ATTTGCCAGA GGTGTTAGAA CTCCCGAACT ATAGTCCCTA TTTTTTCGTC TTTGTCACCA TAGTCAGAGC ATGCGGCGAG TTAATTGGCA TCGAGCCGCA GCAGATCAAG CAAAGTTAAA TGCCCCCGAG AGTGATCATA AATCAAATGT TTTTAAGCTA TAGATCCGTC AGTACTTTTG AGGACATGAC AGCGTCGCAT GCGGTCTCAG TGCGCAGACA AAGCTATCTG GGGGATCGGA TCTCCACAGA ATGTACTCAG TCGGTGTGAG TAAAGAGTGG AAGACGGGGC GGGTCTTGGA GCGTGCTATA AGCAGAAGGT ATGAGGTATG TGCTTCGCGC ATTTCGTCCA GATACAGGCC CTCACGCTTA TAGCCGTTCC ACTGGTAGTA CCGCTCGCGC CGTTCTGTCT AGCCCCGGCT CGTGATTCTA TCAGGCCCGT CCCTGGCTAC AGACATCAGT ATAGATAAAT CAACTCTCGG TGATTCTAAA CGTATAGAGT TGTGAAAAAC GCTGCAAGCA TCCCCATCGA AGCCTTTGTC TCTTTCCCTC AGTGGACTTT CTACTACCAT CTTAGCTACT CCATCGCAAT AGTTCCCAGG CGTGCTATAT GGGCGTTTCA TCTACGAGGC ACGTTTTAGC ATGGACGTCG GCTATATAAT TGTACTCATT GCCAGAGCAG ACGTGAGTTT CGGATCGGAC CCTGGAATTA ATATTGGCCA CCCTTTTTGT TTGGCCATGT GAAGTACCCG AGCTAGTGTA CCCTGTCGAA ACGCTATATG CTGACAATCT CGACATACCC TACCGCCACG TATGATTATC GCTGGGAATT TTAATCGTGA GTGAGTTTTG CCACTACCAT AGTTTGCTGA ATTCAAGTTG GTCACGGAAC TCATGTAGAT GACACGGCTA AAGGCTTCTG TTCGTTACGG CCGAGCATTC AACGGTGATA TTTAATTGGC CAAGTTGTAA TTTTCCGCGT TTATACGTCA TTCCTATAGC TTAGAGTGAT GTGACTCCCG GTTTCCTACC TTGCAACTAA TAGAATGCAC TGCCCACACG TATAATGCGG GAGCGCACTG AGCACACGTT TAGTTGCTTC TGTATGCCTA TCTTCCCTGG TCTGACCGAA CGACGGCCAA TATAATAAAC GTAGCACCTA CCTAATTTGT TAAGTTGCTA CCGGCCTCTG TTCCCGTATA TATTCTTGGC CATTTAACAT CGAGGCGGAA CACAGCGTGC TTGAAGCGAA GATAAATAAA CCATGAGTCA AACTAGATTG AGTATTTAGA GCTCCTCGCC CCGTCAGACA TATCTTTCGT TTGGCTTACA GGTAAGCCTC TGTATCGCAT CGGGCTCGGT TCAGACACTC TACACCTCTT ATTTAAAACA GGAACCGGGA AAGTATGCTA TCGACATGGT ACCGGGACGC CAGAAGGTTG ACTCTTCAGT GTACTTTTCC CGACATTTGT AAAGTCGGTG TTTGGGAGAG GAGATCCACC CGTAGATTCG ATGCCCTGTG GTTCCTCACC TAGGTGCTGT AGCGTGCGGC CTGAGACGAC GTAGTTGCAG CGAGGGAGTC CGACGCTATA TGCTGTGCTT CAGGGAAATT AGTCCGACGC AAGAGGACAA ATAGAGTCTC GTGGGTAAGA ATCCGTTGCA TTATAAAGCC GCTCTGTGGG GTACAACAAG AAACGTACCA CGTTTTCGTA GGAGTCCAAT CTTTGACCTG CCGTATATTT TATGCTTTAT TTCAATCATT GGACTTTCTC TTTCTATTGT CTGCAGTAGG TAAACGTACC CTGACTTTAC ACAGCCCTGC CCGCACTCAA TCTGGGCCTC AGCATCGATA ACTGCACCGC GGTGACACCC TCGCAATGTG TTCAAGCTGA GTGAGCGACA TAGACGATAG ATATGTCTGG ATTTGTCACC CATGTACTCA TACTCTCTTA CGATCATGTG TCTCAGTTTT TCTTGGAAGG GTTTTGAAGC ACTCAAGTAT CAGAGCACTC CATGGACGTC CTATACTCTT GCATCCATGG TATCTTTTCC TGCTTCGAAG GCTCAGATCA ACCGCCTACG GGCAAGGCTG GGTGGTGAAT ACCTCTTGGG GAGGTCGGGG GGCTATTGAC CCTGCTCATC GAGGGAGTCC GTTTTCGTAT TTTGCTTGTG GGGTCCCGAC CCATGAAGGA TCGATCATTG AGAGTCTCCT TAGTAGACCT CAGCTGAGAC TGCCTAAATT TTGCTTGTGT TTGCAGAGCA TCTGAAAAGC TCGGAGCACT TTTTTGTTAT CTACCGCTAC TGCCAGATAG GACATAGATG GTAAGGATTA ACCCTATAAC ATCGGACCCG AATCGTGATT GCGCGTGTAT TGCCTGGATG GCCGAGGCCA CCGCGTGCTA CTATTCATTT TTTGACCTGC GACTGACTGC TTAGAAAGCC ACCACGGGCT"
    print(*solve_burrows_wheeler_matching(string, patterns))